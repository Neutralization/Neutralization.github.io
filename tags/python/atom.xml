<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>python on Hâº + OHâ» â†’ Hâ‚‚O</title><link>https://naizi.ch/tags/python/</link><description>Recent content in python on Hâº + OHâ» â†’ Hâ‚‚O</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 09 Aug 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://naizi.ch/tags/python/atom.xml" rel="self" type="application/rss+xml"/><item><title>è®°å½•ä¸€äº›å’Œ Unicode ä¸æ–­ä½œæ–—äº‰çš„æ—¥å­</title><link>https://naizi.ch/2022/08/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%BA%9B%E5%92%8C-unicode-%E4%B8%8D%E6%96%AD%E4%BD%9C%E6%96%97%E4%BA%89%E7%9A%84%E6%97%A5%E5%AD%90/</link><pubDate>Tue, 09 Aug 2022 00:00:00 +0000</pubDate><guid>https://naizi.ch/2022/08/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%BA%9B%E5%92%8C-unicode-%E4%B8%8D%E6%96%AD%E4%BD%9C%E6%96%97%E4%BA%89%E7%9A%84%E6%97%A5%E5%AD%90/</guid><description>&lt;p>æœ€å¼€å§‹ç»™å“”å“©å“”å“©å‘¨åˆŠå†™&lt;a class="link" href="https://github.com/Neutralization/BiliBiliRankingScripts" target="_blank" rel="noopener"
>&lt;code>è‡ªåŠ¨åŒ–è„šæœ¬&lt;/code>&lt;/a>çš„æ—¶å€™ï¼Œè¿˜ä¸è§‰å¾—ç”Ÿæˆå›¾ç‰‡èƒ½é‡åˆ°ä»€ä¹ˆå‘ã€‚æ¯•ç«Ÿä¹‹å‰ä¹Ÿç”¨è¿‡ Pillow åº“ï¼Œç®—æ˜¯æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚è€Œä¸”é‡åˆ°çš„éƒ½æ˜¯äº›åœ¨æ™®é€šä¸è¿‡çš„æ­£å¸¸æ–‡æœ¬ã€‚&lt;/p>
&lt;p>ç›´åˆ°èº²ä¸å¼€çš„ emoji å¼€å§‹å‡ºç°äº†ã€‚&lt;/p>
&lt;h2 id="ä¸€äº›æ™®é€šçš„-emoji">ä¸€äº›æ™®é€šçš„ Emoji&lt;/h2>
&lt;p>â˜€â˜â˜‚â˜ƒâ˜„â˜â˜‘â˜”â˜•â˜˜&lt;/p>
&lt;p>åˆšå¼€å§‹é‡åˆ°è¿™ç±»ä¹Ÿè¿˜å¥½ï¼Œå› ä¸ºå¾ˆæ˜¾ç„¶ï¼Œåªæ˜¯æ–‡æœ¬çš„å­—ä½“æ²¡æœ‰è¿™éƒ¨åˆ† emojiï¼ŒPillow å°±å…¨éƒ¨ç»™æ˜¾ç¤ºæˆäº†æ–¹æ¡†ã€‚ç®€å•æ¡†äº†ä¸ªèŒƒå›´ï¼Œç”¨å¦ä¸€ä¸ªå­—ä½“æ¥æ¸²æŸ“å°±æ˜¯äº†ã€‚&lt;/p>
&lt;p>ä½†åæ¥å°±å¼€å§‹é‡åˆ°å„ç§æ ‡é¢˜é‡Œçš„èŠ±æ´»ï¼Œä»€ä¹ˆä¸Šä¸‹æ ‡å­—ç¬¦èŠ±ä½“å­—ç²—æ–œä½“å…¨æ¥äº†ã€‚æ¯”å¦‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://www.bilibili.com/video/BV1xV41167qm" target="_blank" rel="noopener"
>ã€ğŸ’ğŠ ğŸ”ğŸğ…ğğ’ã€‘è¿™é¦–ã€Šğ‘­ğ’‚ğ’ğ’ğ’Šğ’ğ’ˆ ğ‘¨ğ’ˆğ’‚ğ’Šğ’ã€‹å¦‚ä»Šæ²»æ„ˆäº†å¤šå°‘äººï¼ï¼! â„³â‚¯ã•-æ²‰ æ²¦&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è‡ªæ­¤çœŸæ­£æ‰“å“äº†ä¸ Unicode æ–—äº‰çš„ç¬¬ä¸€æªã€‚&lt;/p>
&lt;h2 id="ä¸€äº›æ™®é€šçš„-unicode">ä¸€äº›æ™®é€šçš„ Unicode&lt;/h2>
&lt;p>ä¸Šä¸‹æ ‡å­—ç¬¦èŠ±ä½“å­—ç²—æ–œä½“ä¹Ÿèƒ½æ¥å—ï¼Œäººå®¶çœ‹èµ·æ¥è‡³å°‘è¿˜æ˜¯ä¸ªæ­£ç»å­—ç¬¦ã€‚è§£å†³æ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„ç®€å•ç²—æš´ï¼šæ‰¾ä¸€ä¸ªå®šä¹‰äº†è¿™éƒ¨åˆ†å­—ç¬¦çš„å­—ä½“ï¼Œå•ç‹¬åŒ¹é…æ¸²æŸ“ã€‚&lt;/p>
&lt;p>äºæ˜¯è„šæœ¬é‡Œçš„ UnicodeA_F æ…¢æ…¢å¢åŠ åˆ°äº† UnicodeD_Fã€‚åˆ’ä¸€ä¸ªæ–°çš„æ­£åˆ™èŒƒå›´ï¼ŒåŒ¹é…ä¸Šä¸€ä¸ªæ–°çš„å­—ä½“ï¼Œå¦‚æ­¤æŸ¥æ¼è¡¥ç¼ºçš„å·¥ä½œä¹Ÿè¿˜èƒ½æ¥å—ï¼Œæ¯•ç«Ÿé‡åˆ°ç‰¹æ®Šå­—ç¬¦çš„åœºåˆç›¸å¯¹è¿˜æ˜¯éå¸¸æœ‰é™çš„ã€‚&lt;/p>
&lt;p>ç›´åˆ°çœŸæ­£çš„é‡é‡çº§ä¸Šåœºäº†ã€‚&lt;/p>
&lt;h2 id="combining-å­—ç¬¦">Combining å­—ç¬¦&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.bilibili.com/video/BV1U44y1E7Wm" target="_blank" rel="noopener"
>âœ¥æˆ‘Ò‰ÍÍ›Ì€ÌˆÌˆÌ¾ÍƒÍ€Í‚ÌŠçš„æ¨¡Ò‰ÍÍ¢Ì‹ÍƒÍ‹ÌˆÌ‘Í‹Ì‰Ì–Ì­Ì±ÍÌ©Í•Í“Í…æ ·å“ÒˆÍÌÌÌ…ÌšÌ’ÌÍ‚Í„.åˆ°ä½ ÒˆÌ›ÍÌÌ„ÍÌƒÍ—ÍƒÍ’Í’ÍŠÌ¿Í›Ì’äº†ï¼Ÿï½â¤âœ¥&lt;/a>&lt;/p>
&lt;p>åªèƒ½æ‰¿è®¤å®ƒæ€æ­»äº†æ¯”èµ›ã€‚ä½†å…¶å®ç±»ä¼¼çš„æ ‡é¢˜å¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œåœ¨æ›´æ—©ä¹‹å‰ï¼Œæˆ‘ç®—æ˜¯è§è¿‡å®ƒçš„ä¸€ä½å¤§å‰è¾ˆï¼š&lt;/p>
&lt;p>&lt;a class="link" href="https://www.nicovideo.jp/watch/sm28869680" target="_blank" rel="noopener"
>&lt;img src="https://naizi.ch/pic/2022-08-09-fight-with-unicode/Snipaste_2022-08-10_16-32-58.png"
loading="lazy"
alt="ã€åˆéŸ³ãƒŸã‚¯ã€‘å®‡å®™å¤§è§„æ¨¡ 11 æ¬¡å…ƒæ„é€ ä½“ã€ATOLSã€‘"
>&lt;/a>&lt;/p>
&lt;p>è¿™ä½å‰è¾ˆæ›´æ˜¯é‡é‡çº§ï¼Œå³ä¾¿åœ¨å†™è¿™ç¯‡è®°å½•çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸ä½©æœè¿™ç§å’Œè§†é¢‘å¥‘åˆçš„æ ‡é¢˜é£æ ¼ç¡®å®æ˜¯éå¸¸åˆ°ä½ã€‚&lt;/p>
&lt;p>èƒ½åšåˆ°è¿™ç§æ•ˆæœçš„åŸå› æ˜¯ç”±äºå…¶ä¸­å¤§é‡çš„ Combining å­—ç¬¦ï¼Œæ¯”å¦‚æ—¥æ–‡çš„æ¸…æµŠéŸ³ç¬¦å·ï¼Œéƒ¨åˆ†å°è¯­ç§çš„éŸ³æ ‡å’Œä¸€äº›ç‹¬ç‰¹çš„ç»„è¯æ–¹å¼ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ Pillow ç½¢å·¥äº†å‘€ï¼Œè‡£å¦¾æ¸²æŸ“ä¸æ¥ï¼Œæ‚¨è¿˜æ˜¯å¦è¯·é«˜æ˜å§ã€‚&lt;/p>
&lt;p>æ€æ¥æƒ³å»ä¸å¾—æ³•ï¼Œæœ€åæƒ³åˆ°ï¼Œé‚£æ—¢ç„¶ç½‘é¡µå‰ç«¯èƒ½å¤Ÿæ­£å¸¸å±•ç¤ºï¼Œåº”è¯¥å¯ä»¥é€šè¿‡æ— å¤´æµè§ˆå™¨å‰ç«¯æ¸²æŸ“ç„¶åæˆªå±çš„æ–¹å¼ï¼ŒæŠŠè¿™äº›ç‰¹æ®Šå­—ç¬¦æ­£ç¡®çš„æ˜¾ç¤ºå‡ºæ¥ã€‚&lt;/p>
&lt;p>ç®€å•ç³Šäº†ä¸ªé¡µé¢ï¼Œç®—æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å“”å“©å“”å“©å‘¨åˆŠä¸ Unicode çš„æ–—äº‰ä¹Ÿç®—æ˜¯å‘Šä¸€æ®µè½äº†ã€‚&lt;/p>
&lt;h2 id="mad-å‘¨åˆŠæ–°çš„æŒ‘æˆ˜">MAD å‘¨åˆŠï¼Œæ–°çš„æŒ‘æˆ˜&lt;/h2>
&lt;p>æ¥æ‰‹å¼€å§‹&lt;a class="link" href="https://github.com/Neutralization/MADRankingScripts" target="_blank" rel="noopener"
>&lt;code>MAD å‘¨åˆŠçš„è‡ªåŠ¨åŒ–&lt;/code>&lt;/a>åï¼Œå¾ˆå¿«åˆä¸å¾—ä¸é¢å¯¹ Unicode å¸¦æ¥çš„é—®é¢˜ã€‚ç„¶è€Œå®é™…ä¸Šï¼Œåº”è¯¥è¯´æ˜¯ Unicode å’Œ Adobe å…±åŒå¸¦æ¥çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¿è¯åŸå§‹ MAD å‘¨åˆŠå·¥ç¨‹æ–‡ä»¶çš„çº¯æ´æ€§ï¼Œæ‰€æœ‰çš„æ–‡æœ¬éƒ½æŒ‰ç…§æ–‡æœ¬å›¾å±‚æ¥è¿›è¡Œä¿®æ”¹ã€‚æœ¬æ¥è¿™ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p>
&lt;p>ä½†æ˜¯åŸå·¥ç¨‹ä½¿ç”¨çš„å¤§é‡è¡¨è¾¾å¼ï¼Œæ˜¯åŸºäºæ—§ç‰ˆçš„ ExtendScript å¼•æ“ï¼Œæ¯•ç«Ÿå·¥ç¨‹æœ¬èº«æ˜¯ 2016 å¹´çš„äº§ç‰©ã€‚ä½†ä¹‹å‰åšå“”å“©å“”å“©å‘¨åˆŠæ—¶ä¸€ç›´ç”¨çš„æ˜¯ JavaScript å¼•æ“çš„è¡¨è¾¾å¼ï¼Œè¿™å°±äº§ç”Ÿäº†å‡ ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>ç‰¹æ®Šçš„ Unicode å­—ç¬¦éœ€è¦ä½¿ç”¨ä¸åŒçš„å­—ä½“æ‰èƒ½æ­£å¸¸æ˜¾ç¤º&lt;/li>
&lt;li>ExtendScript ä¸èƒ½ä¿®æ”¹æ–‡æœ¬å›¾å±‚çš„éƒ¨åˆ†å­—ä½“æ ·å¼å±æ€§&lt;/li>
&lt;li>ç›¸æ¯” ExtendScriptï¼ŒJavaScript èƒ½å¤Ÿä¿®æ”¹å­—ä½“å­—å·é¢œè‰²ç­‰å±æ€§&lt;/li>
&lt;li>ä¸ºäº†ä½¿ç”¨ JavaScript å¼•æ“å°±è¦æŠŠæ•´ä¸ªå·¥ç¨‹çš„å…¶ä»–è¡¨è¾¾å¼å…¨éƒ¨é‡å†™&lt;/li>
&lt;li>AfterEffects å¯¹é€šè¿‡è„šæœ¬ä¿®æ”¹å­—ä½“çš„è¡Œä¸ºæœ‰å¥‡æ€ªçš„é—®é¢˜ï¼Œä¸èƒ½ä¿è¯æ­£å¸¸æ˜¾ç¤º&lt;/li>
&lt;/ol>
&lt;p>ç”±äºå·¥ä½œé‡å¤ªå¤§ï¼Œé‡å†™å…¨éƒ¨è¡¨è¾¾å¼æ˜¾ç„¶ä¸ç°å®ã€‚åŸºäºæ­¤ï¼Œæˆ‘é€‰æ‹©äº†å¦ä¸€ç§æ–¹å¼ï¼šè®©æ‰€æœ‰èŠ±æ´»éƒ½å˜æˆæ­£å¸¸çš„å­—ç¬¦ã€‚&lt;/p>
&lt;p>è¿™å°±éœ€è¦æœ‰ä¸€ä¸ªè¡¨æ¥è®°å½•è¿™äº›ç‰¹æ®Šå­—ç¬¦åº”è¯¥è¢«æ›¿æ¢ä¸ºå…·ä½“å“ªä¸€ä¸ªå­—ç¬¦ï¼Œäºæ˜¯è¯ç”Ÿäº† &lt;a class="link" href="https://github.com/Neutralization/Antimemetics-Division" target="_blank" rel="noopener"
>&lt;code>Antimemetics-Division&lt;/code>&lt;/a> è¿™æ ·ä¸€ä¸ªå¯¹æŠ—é¡¹ç›®ã€‚&lt;/p>
&lt;p>æœŸé—´åˆ™æ˜¯æ¯ç‡¥çš„ Unicode æŸ¥è¡¨æµè§ˆè¿‡ç¨‹ï¼Œå°½å¯èƒ½å¤šçš„æœé›†è¿™ç±»ç‰¹æ®Šå­—ç¬¦çš„æ ‡é¢˜æ¥ä¿è¯æ›´å¹¿çš„è¦†ç›–é¢ã€‚&lt;/p>
&lt;p>è€Œå Emoji çš„é—®é¢˜ä¹Ÿéœ€è¦å¤„ç†ï¼Œè¿™å°±è¦åˆ’åˆ† Emoji çš„ Unicode å­—ç¬¦èŒƒå›´ã€‚å¹¸å¥½è¿™éƒ¨åˆ†æœ‰æ®å¯æŸ¥ï¼Œåœ¨ Unicode å®˜æ–¹è§„èŒƒä¸­æœ‰è¯¦ç»†çš„è®°å½•å„ä¸ª Emojiã€‚&lt;/p>
&lt;p>Combining å­—ç¬¦çš„é—®é¢˜ä¹Ÿå¾—åˆ°äº†è§£å†³ï¼ŒUnicode å®˜æ–¹è§„èŒƒä¸­è§„å®šäº† Mc Me Mn ä¸‰ç±» Mark å­—ç¬¦æ­£å¥½èƒ½å¤Ÿè¦†ç›–è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>æœ€ç»ˆ Antimemetics-Division ä¸è´Ÿä½¿å‘½ï¼Œè®© MAD å‘¨åˆŠä¸­çš„æ ‡é¢˜éƒ½æˆä¸ºäº†â€œæ­£ç»æ ‡é¢˜â€ï¼Œå¯å–œå¯è´ºï¼Œå¯å–œå¯è´ºã€‚&lt;/p>
&lt;p>&lt;del>è™½ç„¶ç•™ä¸‹äº†åå‘åˆ©ç”¨æ­¤é¡¹ç›®å¯ä»¥ç”Ÿæˆæ›´åŠ è®©äººè¡€å‹çˆ†ç‚¸çš„æ ‡é¢˜çš„é—®é¢˜ï¼Œæš‚ä¸”ä¸æ&lt;/del>&lt;/p>
&lt;h2 id="æœ¬å¯ä»¥æ›´ä¼˜é›…çš„è§£å†³æ–¹å¼">æœ¬å¯ä»¥æ›´ä¼˜é›…çš„è§£å†³æ–¹å¼&lt;/h2>
&lt;p>å¦‚æ˜¯å‡ æœŸè§†é¢‘æ›´æ–°åï¼Œæˆ‘é€æ¸æ„è¯†åˆ°ä¸€ç§å‰²è£‚æ„Ÿã€‚&lt;/p>
&lt;p>ä¸ºä»€ä¹ˆå“”å“©å“”å“©å‘¨åˆŠå°±åº”è¯¥æ¸²æŸ“æ­£å¸¸ï¼ŒMAD å‘¨åˆŠå°±è¦å»æ‰è¿™äº›å­—ç¬¦å‘¢ï¼Ÿè¿™ç§åŒºåˆ«å¯¹å¾…è¯´ç™½äº†ï¼Œä¸è¿‡è¿˜æ˜¯ä¸€ç§æ‡’æƒ°ã€‚&lt;/p>
&lt;p>ä¸åŒäºæˆ‘æœ€åˆæ‰¿è®¤ ATOLS ç©çš„ä¸€æ‰‹å¥½æ ‡é¢˜ï¼Œåœ¨ MAD å‘¨åˆŠä¸Šæˆ‘åè€Œä»¥å­—ç¬¦è®ºæ ‡é¢˜ä¼˜åŠ£ï¼Œä¸åº”æ˜¯æ­£ç¡®çš„è§£æ³•ã€‚&lt;/p>
&lt;p>äºæ˜¯å†³å®šåŒå“”å“©å“”å“©å‘¨åˆŠä¸€æ ·é€šè¿‡å‰ç«¯æˆªå›¾æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åŒæ—¶è€ƒè™‘åˆ°æ’ç‰ˆå½±å“ï¼Œéƒ¨åˆ† MAD æ ‡é¢˜å¸¸ç”¨å…¨è§’ç¬¦å·ï¼Œå¯¼è‡´æ ‡é¢˜çš„èµ·å§‹åƒç´ ä½ç½®å…¶å®å¹¶ä¸é¡¶æ ¼ï¼Œä¾¿åœ¨è„šæœ¬ä¸­åŠ å…¥äº†ä¸€ä¸ªç²—ç•¥çš„åˆ¤æ–­ï¼Œè¿›è¡Œä¸€ä¸ª X è½´çš„ç§»ä½ä½¿å¾—è§†è§‰ä¸Šæ˜¾å¾—æ›´å¯¹é½ä¸€äº›ã€‚&lt;/p>
&lt;p>ä½† Emoji è¿˜æ˜¯ç»™æˆ‘æ£äº†ä¹±ï¼ŒEmoji å› ä¸ºéƒ½æ˜¯å…¨è§’å®½åº¦ï¼Œæ— æ³•åˆ¤æ–­åƒç´ ä½ç½®æ˜¯å¦é¡¶æ ¼ï¼Œè¿™ä¸ªé—®é¢˜åªèƒ½ç•™åˆ°ä¹‹åå†å¯»æ‰¾åˆé€‚çš„è§£æ³•äº†ã€‚&lt;/p>
&lt;h3 id="update-20221003">Update 2022/10/03&lt;/h3>
&lt;p>æˆäº†ï¼Œç”Ÿæˆå›¾ç‰‡ç„¶ååˆ‡å·¦å³é€æ˜åƒç´ å°±æ˜¯äº†ï¼Œ&lt;a class="link" href="https://github.com/Neutralization/MADRankingScripts/commit/100cb976e83db6e9f45575e43742b2bed3ca598b#diff-627c0a0588769c50e32e1fc457e9c787835f1d5ad8ff6845142d32b63589b1ff" target="_blank" rel="noopener"
>é—®é¢˜è§£å†³&lt;/a>ï¼ˆ&lt;/p>
&lt;h2 id="æœªå°½ä¹‹äº‹">æœªå°½ä¹‹äº‹&lt;/h2>
&lt;p>è®¡åˆ’å°†å“”å“©å“”å“©å‘¨åˆŠçš„å›¾ç‰‡ç”Ÿæˆä¹Ÿæ”¹ä¸ºå‰ç«¯æˆªå›¾çš„æ–¹å¼ã€‚ä¸”ä¸è°ˆç‰¹æ®Šå­—ç¬¦çš„é—®é¢˜ï¼Œå‰ç«¯è¿™ç§æ–¹ä¾¿å¯è§†åŒ–è°ƒæ•´çš„å½¢å¼ï¼Œåº”è¯¥ä¼šå¯¹ä»£ç ä¿®æ”¹æ›´å‹å¥½ä¸€äº›ï¼Œè™½ç„¶æƒ³æ¥æ˜¯ä¸ä¼šæœ‰ä»€ä¹ˆæ”¹ç‰ˆå’Œä¿®æ”¹äº†ã€‚&lt;/p>
&lt;p>è€Œä¸”é€šè¿‡ CSSï¼Œè¿˜èƒ½å¤Ÿå®ç°ä¸€äº› Pillow åšä¸åˆ°çš„æ–‡æœ¬æ ·å¼æ•ˆæœï¼Œæ›´å¥½çš„è¿˜åŸ PSD çš„è®¾è®¡æ ·å¼ã€‚&lt;/p>
&lt;p>æ›¾ç»è¿˜æƒ³è¿‡å†™ Photoshop è„šæœ¬æ¥åšå›¾ï¼Œè™½ç„¶è¿˜æ²¡è¯•éªŒè¿‡ Photoshopï¼Œè€ƒè™‘åˆ°å‰è¿° AfterEffects æ–‡æœ¬å›¾å±‚çš„é—®é¢˜ï¼Œä»¥åŠå‰ç«¯æˆªå›¾ç¡®å®æ›´çµæ´»ï¼Œä¹Ÿå°±ä¸å†è€ƒè™‘äº†ã€‚&lt;/p></description></item><item><title>Python ä½¿ç”¨ USB çƒ­æ•æ‰“å°æœº</title><link>https://naizi.ch/2020/07/07/python-%E4%BD%BF%E7%94%A8-usb-%E7%83%AD%E6%95%8F%E6%89%93%E5%8D%B0%E6%9C%BA/</link><pubDate>Tue, 07 Jul 2020 00:00:00 +0000</pubDate><guid>https://naizi.ch/2020/07/07/python-%E4%BD%BF%E7%94%A8-usb-%E7%83%AD%E6%95%8F%E6%89%93%E5%8D%B0%E6%9C%BA/</guid><description>&lt;p>é€šè¿‡ä½¿ç”¨ python-escpos åº“ï¼Œå°±å¯ä»¥å’Œå¸¸è§çš„ USB çƒ­æ•æ‰“å°æœºé€šä¿¡æ¥è¿›è¡Œæ‰“å°ï¼Œä¸å†èµ˜è¿°å…·ä½“æ–¹æ³•ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ python-escpos åº“å¹¶ä¸æ˜¯ä¸º Windows å†™çš„ï¼Œå®é™…åœ¨ä½¿ç”¨çš„æ—¶å€™å°±ä¼šå‡ºç°è®¸å¤šçš„é—®é¢˜ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯&lt;/p>
&lt;blockquote>
&lt;p>ValueError: No backend available&lt;/p>
&lt;/blockquote>
&lt;p>æ ¹æ®&lt;a class="link" href="https://stackoverflow.com/questions/13773132/pyusb-on-windows-no-backend-available" target="_blank" rel="noopener"
>Stackoverflow&lt;/a>ä¸Šçš„è§£ç­”ï¼Œåº”è¯¥æ˜¯ç¼ºå°‘ dll æ–‡ä»¶ï¼ŒæŒ‰è§£ç­”ä¸­æä¾›çš„é“¾æ¥åœ°å€ä¸‹è½½å®‰è£…å°±è¡Œäº†ã€‚&lt;/p>
&lt;p>ä½†å®‰è£…åä¼šå‡ºç°æ–°çš„é”™è¯¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>NotImplementedError: Operation not supported or unimplemented on this platform&lt;/p>
&lt;/blockquote>
&lt;p>æ‰€å¹¸åœ¨ python-escpos çš„ Github &lt;a class="link" href="https://github.com/python-escpos/python-escpos/issues/316" target="_blank" rel="noopener"
>issue316&lt;/a>ä¸­æœ‰äººæä¾›äº†è§£å†³æ–¹å¼ã€‚ç›´æ¥ä¿®æ”¹æºä»£ç ï¼Œåˆ å»å¯¹åº”çš„å¼‚å¸¸æ•æ‰ï¼Œå°±èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨äº†ã€‚&lt;/p>
&lt;p>æ­¤å¤„ç•™æ¡£ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚&lt;/p></description></item><item><title>æ¥ä¸€åœºåœ†å‘¨ç‡çš„é£èŠ±ä»¤</title><link>https://naizi.ch/2019/11/26/%E6%9D%A5%E4%B8%80%E5%9C%BA%E5%9C%86%E5%91%A8%E7%8E%87%E7%9A%84%E9%A3%9E%E8%8A%B1%E4%BB%A4/</link><pubDate>Tue, 26 Nov 2019 00:00:00 +0000</pubDate><guid>https://naizi.ch/2019/11/26/%E6%9D%A5%E4%B8%80%E5%9C%BA%E5%9C%86%E5%91%A8%E7%8E%87%E7%9A%84%E9%A3%9E%E8%8A%B1%E4%BB%A4/</guid><description>&lt;p>é€›å¾®åšçœ‹åˆ°äº†ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼šå±±ä¸œå«è§†ã€Šå›½å­¦å°åå£«ã€‹ç¬¬ä¸‰å­£çš„èŠ‚ç›®ï¼Œè¿›è¡Œäº†ä¸€åœº Ï€(åœ†å‘¨ç‡) çš„é£èŠ±ä»¤ã€‚&lt;/p>
&lt;p>èŠ‚ç›®é‡Œé€‰æ‰‹ä»¬æ¥åˆ°äº†å°æ•°ç‚¹å 204 ä½ï¼Œé‚£ï¼Œèƒ½ä¸èƒ½æ›´é•¿ä¸€ç‚¹ï¼Ÿ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="æ•°æ®å‚¨å¤‡">æ•°æ®å‚¨å¤‡&lt;/h2>
&lt;p>é¦–å…ˆéœ€è¦æœ‰è¶³å¤Ÿå¤šçš„å¤è¯—è¯å‚¨å¤‡ï¼Œä¸ç„¶ç¨‹åºç”Ÿæˆçš„æ—¶å€™è€—å…‰å¼¹è¯å°±æ˜¾å¾—éå¸¸å°´å°¬äº†ã€‚&lt;/p>
&lt;p>éå¸¸æ„Ÿè°¢&lt;a class="link" href="https://github.com/chinese-poetry/chinese-poetry" target="_blank" rel="noopener"
>chinese-poetry&lt;/a>è¿™æ ·çš„å¼€æºé¡¹ç›®ï¼Œç§¯ç´¯äº†å¤§é‡çš„å·²ç»ç»“æ„åŒ–çš„å¤è¯—è¯æ•°æ®ã€‚&lt;/p>
&lt;p>è¿™é‡Œåªç”¨å®‹è¯éƒ¨åˆ†çš„æ•°æ®ã€‚&lt;/p>
&lt;h2 id="ç®—æ³•é€»è¾‘">ç®—æ³•é€»è¾‘&lt;/h2>
&lt;p>é€»è¾‘å¾ˆç®€å•ç²—æš´ï¼šæ‰¾å‡ºæ‰€æœ‰åŒ…å«ä¸­æ–‡æ•°å­—çš„è¯å¥è¿›è¡Œæ±‡æ€»ï¼Œç„¶åæŒ‰å°æ•°ç‚¹åä½æ•°è¿­ä»£ Ï€ å€¼éšæœºå–å¯¹åº”çš„è¯—è¯å°±è¡Œã€‚&lt;/p>
&lt;p>æ•´ç†è¯—è¯æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> re
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>filelist &lt;span style="color:#f92672">=&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> file &lt;span style="color:#66d9ef">for&lt;/span> file &lt;span style="color:#f92672">in&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>listdir(&lt;span style="color:#e6db74">&amp;#39;./json&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">if&lt;/span> re&lt;span style="color:#f92672">.&lt;/span>search(&lt;span style="color:#e6db74">r&lt;/span>&lt;span style="color:#e6db74">&amp;#39;poet.song&amp;#39;&lt;/span>, file)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>files &lt;span style="color:#f92672">=&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> json&lt;span style="color:#f92672">.&lt;/span>load(open(&lt;span style="color:#e6db74">&amp;#39;./json/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> file, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> file &lt;span style="color:#f92672">in&lt;/span> filelist
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>result &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;ä¸€&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;äºŒ&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;ä¸‰&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;å››&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;äº”&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;å…­&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;ä¸ƒ&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;å…«&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;ä¹&amp;#39;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;é›¶&amp;#39;&lt;/span>: []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> file &lt;span style="color:#f92672">in&lt;/span> files:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> file:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> y &lt;span style="color:#f92672">in&lt;/span> x[&lt;span style="color:#e6db74">&amp;#39;paragraphs&amp;#39;&lt;/span>]:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> z &lt;span style="color:#f92672">in&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;ä¸€&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;äºŒ&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;ä¸‰&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;å››&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;äº”&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;å…­&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;ä¸ƒ&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;å…«&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;ä¹&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;é›¶&amp;#39;&lt;/span>]:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ã€€ &lt;span style="color:#66d9ef">if&lt;/span> re&lt;span style="color:#f92672">.&lt;/span>search(z, y):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result[z] &lt;span style="color:#f92672">=&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>get(z) &lt;span style="color:#f92672">+&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#ae81ff">\n\t\t\t\t&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(y, x[&lt;span style="color:#e6db74">&amp;#39;author&amp;#39;&lt;/span>], x[&lt;span style="color:#e6db74">&amp;#39;title&amp;#39;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;step.json&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;w&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(json&lt;span style="color:#f92672">.&lt;/span>dumps(result, ensure_ascii&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="Ï€-å€¼è®¡ç®—">Ï€ å€¼è®¡ç®—&lt;/h2>
&lt;p>æ— è„‘å¥—ç”¨äº†ä¸€ä¸‹åˆ«äººçš„ä»£ç ï¼š&lt;a class="link" href="http://z-rui.github.io/post/2015/06/pi-digits/" target="_blank" rel="noopener"
>http://z-rui.github.io/post/2015/06/pi-digits/&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">pidigits&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q, r, t, u, i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">180&lt;/span>, &lt;span style="color:#ae81ff">60&lt;/span>, &lt;span style="color:#ae81ff">168&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> &lt;span style="color:#66d9ef">True&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y &lt;span style="color:#f92672">=&lt;/span> r &lt;span style="color:#f92672">//&lt;/span> t
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">yield&lt;/span> y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q, r, t, u, i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">*&lt;/span> q &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">*&lt;/span> (&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>), &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">*&lt;/span> u &lt;span style="color:#f92672">*&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q &lt;span style="color:#f92672">*&lt;/span> (&lt;span style="color:#ae81ff">5&lt;/span> &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> r &lt;span style="color:#f92672">-&lt;/span> y &lt;span style="color:#f92672">*&lt;/span> t), t &lt;span style="color:#f92672">*&lt;/span> u, u &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">54&lt;/span> &lt;span style="color:#f92672">*&lt;/span> (i &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>), i &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸åœè¿­ä»£ pidigits() å°±èƒ½å¾—åˆ°åä¸€ä½å°æ•°æ•°å€¼ã€‚&lt;/p>
&lt;h2 id="å¼€å§‹é£èŠ±ä»¤">å¼€å§‹é£èŠ±ä»¤&lt;/h2>
&lt;p>æµ‹è¯•ä¸€ä¸‹è¿­ä»£åœ†å‘¨ç‡ 1000 ä½&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> random &lt;span style="color:#f92672">import&lt;/span> randint
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>poets &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>load(open(&lt;span style="color:#e6db74">&amp;#39;step.json&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>number &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">1&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;ä¸€&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">2&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;äºŒ&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">3&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;ä¸‰&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">4&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;å››&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">5&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;äº”&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">6&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;å…­&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">7&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;ä¸ƒ&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">8&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;å…«&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">9&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;ä¹&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">0&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;é›¶&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">pidigits&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q, r, t, u, i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">180&lt;/span>, &lt;span style="color:#ae81ff">60&lt;/span>, &lt;span style="color:#ae81ff">168&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> &lt;span style="color:#66d9ef">True&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y &lt;span style="color:#f92672">=&lt;/span> r &lt;span style="color:#f92672">//&lt;/span> t
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">yield&lt;/span> y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q, r, t, u, i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">*&lt;/span> q &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">*&lt;/span> (&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>), &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">*&lt;/span> u &lt;span style="color:#f92672">*&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> q &lt;span style="color:#f92672">*&lt;/span> (&lt;span style="color:#ae81ff">5&lt;/span> &lt;span style="color:#f92672">*&lt;/span> i &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> r &lt;span style="color:#f92672">-&lt;/span> y &lt;span style="color:#f92672">*&lt;/span> t), t &lt;span style="color:#f92672">*&lt;/span> u, u &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">54&lt;/span> &lt;span style="color:#f92672">*&lt;/span> (i &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>), i &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">while&lt;/span> &lt;span style="color:#66d9ef">True&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f &lt;span style="color:#f92672">=&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;result.md&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;w&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> num &lt;span style="color:#f92672">in&lt;/span> pidigits():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> used &lt;span style="color:#f92672">=&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new &lt;span style="color:#f92672">=&lt;/span> poets[number[num]]&lt;span style="color:#f92672">.&lt;/span>pop(randint(&lt;span style="color:#ae81ff">0&lt;/span>, len(poets[number[num]])))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> new &lt;span style="color:#f92672">in&lt;/span> used:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new &lt;span style="color:#f92672">=&lt;/span> poets[number[num]]&lt;span style="color:#f92672">.&lt;/span>pop(randint(&lt;span style="color:#ae81ff">0&lt;/span>, len(poets[number[num]])))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(num, number[num], new)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#ae81ff">\t&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#ae81ff">\t&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> num, number[num],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new&lt;span style="color:#f92672">.&lt;/span>replace(number[num], &lt;span style="color:#e6db74">&amp;#39;`&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">`&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(number[num]))))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> used &lt;span style="color:#f92672">=&lt;/span> used&lt;span style="color:#f92672">.&lt;/span>append(new)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> n &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> n &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sys&lt;span style="color:#f92672">.&lt;/span>exit()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="eof">EOF&lt;/h2></description></item><item><title>jojoï¼Œpython çš„èƒ½åŠ›æ˜¯æœ‰æé™çš„</title><link>https://naizi.ch/2019/10/18/jojopython-%E7%9A%84%E8%83%BD%E5%8A%9B%E6%98%AF%E6%9C%89%E6%9E%81%E9%99%90%E7%9A%84/</link><pubDate>Fri, 18 Oct 2019 00:00:00 +0000</pubDate><guid>https://naizi.ch/2019/10/18/jojopython-%E7%9A%84%E8%83%BD%E5%8A%9B%E6%98%AF%E6%9C%89%E6%9E%81%E9%99%90%E7%9A%84/</guid><description>&lt;p>&amp;ndash;&amp;gt; jojoï¼Œpython çš„èƒ½åŠ›æ˜¯æœ‰æé™çš„ã€‚&lt;/p>
&lt;p>&amp;ndash;&amp;gt; æˆ‘ä»çŸ­æš‚çš„äººç”Ÿå½“ä¸­å­¦åˆ°ä¸€ä»¶äº‹&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>&amp;ndash;&amp;gt; è¶Šæ˜¯ç©å¼„ä»£ç ï¼Œå°±è¶Šä¼šå‘ç° python çš„ä¸è¶³&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>&amp;ndash;&amp;gt; é™¤éè¶…è¶Š pythonã€‚&lt;/p>
&lt;p>ä½ åˆ°åº•æƒ³è¯´ä»€ä¹ˆï¼Ÿ&lt;/p>
&lt;p>&amp;ndash;&amp;gt; å”æˆ‘ bash å•¦ï¼&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="èµ·å› ">èµ·å› &lt;/h2>
&lt;p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œå·¥ä½œä¸Šéœ€è¦ä½¿ç”¨åå°å¯¼å…¥äº›æ•°æ®ã€‚&lt;/p>
&lt;p>å­å“§å­å“§æŠŠåŸå§‹æ•°æ®æ•´ç†å®Œï¼Œææˆ csv äº†ï¼Œç‚¹ä¸ªâ€œå¯¼å…¥â€ï¼Œç»™æˆ‘æ¥äº†ä¸ªæŠ¥é”™ï¼š&lt;/p>
&lt;ul>
&lt;li>å•æ¬¡å¯¼å…¥åªæ”¯æŒ 1000 æ¡&lt;/li>
&lt;/ul>
&lt;p>å´½å•Šï¼Œ9102 å¹´æœ«äº†ï¼Œæˆ‘ csv é‡Œé¢è¿‘ç™¾ä¸‡æ¡æ•°æ®ï¼Œä½ è·Ÿæˆ‘è¯´ä¸€æ¬¡ 1000ï¼Ÿæˆ‘ä¸ä¸‹ç­å•¦ï¼Ÿ&lt;/p>
&lt;p>ç„¶è€Œä¼˜ç§€çš„åº•å±‚å‘˜å·¥æ˜¯ä¸ä¼šæŠ±æ€¨è¿™äº›äº‹æƒ…çš„ï¼Œè¡Œå§ï¼Œæˆ‘è‡ªå·±åˆ‡è¡¨æ€»è¡Œäº†å§ã€‚&lt;/p>
&lt;h2 id="å°è¯•-python-åˆ‡å‰²">å°è¯• python åˆ‡å‰²&lt;/h2>
&lt;p>å…ˆç”¨ python çç³Šäº†ä¸€ä¸ªï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>datas &lt;span style="color:#f92672">=&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> n, line &lt;span style="color:#f92672">in&lt;/span> enumerate(open(&lt;span style="color:#e6db74">&amp;#39;test.csv&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>)):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> datas&lt;span style="color:#f92672">.&lt;/span>get(n&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> datas[n&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> datas[n&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>] &lt;span style="color:#f92672">+&lt;/span> [line]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> datas[n&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> [line]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> k,v &lt;span style="color:#f92672">in&lt;/span> datas&lt;span style="color:#f92672">.&lt;/span>items():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;test-&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.csv&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(k), &lt;span style="color:#e6db74">&amp;#39;w&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(v))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‡‘åˆç€ç”¨äº†ï¼Œé¡ºä¾¿å†å†™äº†ä¸ªè„šæœ¬æŠŠåˆ‡å¥½çš„æ–‡ä»¶è‡ªåŠ¨å¯¼å…¥åˆ°åå°ï¼ŒæŠŠå·¥ä½œåšå®Œäº†ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å›è¿‡å¤´äº†ï¼Œå°±å¼€å§‹å«Œå¼ƒ python ä¸å¤Ÿå¿«äº†ã€‚&lt;/p>
&lt;p>è™½ç„¶å¾ˆæ˜æ˜¾åŸå› åœ¨äºæˆ‘ï¼ˆæ¯•ç«Ÿçç³Šå‡‘åˆç”¨ï¼‰ï¼Œæƒ³çœ‹èƒ½ä¸èƒ½æ›´å¿«ä¸€ç‚¹ã€‚&lt;/p>
&lt;p>äºæ˜¯æƒ³èµ·äº† bashï¼Œæƒ³èµ·äº† split å’Œ xargsã€‚&lt;/p>
&lt;h2 id="æ¢æˆ-bash">æ¢æˆ bash&lt;/h2>
&lt;p>è¦åˆ‡å‰²æ–‡ä»¶çš„è¯ split çš„ç¡®å¾ˆæ–¹ä¾¿ï¼š&lt;/p>
&lt;blockquote>
&lt;p>split test.csv -l 1000 -d -a 3 test__&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>-d -a 3&lt;/code>æŒ‡å®šäº†æŒ‰ 3 ä½æ•°é€’å¢æ·»åŠ åç¼€ï¼Œè¿™æ ·å°±èƒ½äº§ç”Ÿ test&lt;strong>001 ~ test&lt;/strong>999 å‘½åçš„åˆ‡å‰²å¥½çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ä½†æ–°çš„é—®é¢˜ä¹Ÿæ¥äº†ï¼Œåˆ‡å‰²å®Œéœ€è¦å…¨éƒ¨åŠ ä¸Šæ–‡ä»¶æ‰©å±•åï¼š&lt;/p>
&lt;blockquote>
&lt;p>mv test_&lt;em>001 test&lt;/em>-001.csv&lt;/p>
&lt;/blockquote>
&lt;p>ä½†æ‰‹å·¥æ“ä½œé‡è¿˜æ˜¯å¤ªå¤§ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ xargs äº†ï¼š&lt;/p>
&lt;blockquote>
&lt;p>ls | grep test__ | xargs -n1 -I file mv file file.csv&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>ls | grep test__&lt;/code>ç­›é€‰äº†æ‰€æœ‰ç¼ºå°‘æ‰©å±•åçš„æ–‡ä»¶ï¼Œç®¡é“å‘½ä»¤ä¼ ç»™ xargs åï¼Œ&lt;code>-n1&lt;/code>ä»£è¡¨ä¸€æ¬¡æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œ&lt;code>-I file&lt;/code>å‘Šè¯‰ xargs åç»­å‘½ä»¤ä¸­çš„&lt;code>file&lt;/code>å…¨éƒ¨ç”¨å‚æ•°å€¼æ›¿æ¢ã€‚&lt;/p>
&lt;p>æ¯”å¦‚åªæœ‰ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œ&lt;code>ls | grep test__&lt;/code>åªæœ‰ä¸€ä¸ªç»“æœ&lt;code>test__001&lt;/code>ï¼Œxargs æ¥æ”¶åˆ°å‚æ•°ï¼Œå°†&lt;code>file&lt;/code>æ›¿æ¢æˆ&lt;code>test__001&lt;/code>ï¼Œå®é™…æ‰§è¡Œå†…å®¹å°±æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>mv test&lt;strong>001 test&lt;/strong>001.csv&lt;/p>
&lt;/blockquote>
&lt;p>å°†ä»–ä»¬ç»„åˆä¸€ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>split -l 1000 test.csv -d -a 3 test**&amp;amp;&amp;amp; ls | grep test** | xargs -n1 -I file mv file file.csv&lt;/p>
&lt;/blockquote>
&lt;p>å›è½¦æ‰§è¡Œï¼Œ1 ç§’éƒ½ä¸éœ€è¦ï¼Œçˆ½æ­»äº†ã€‚&lt;/p>
&lt;h2 id="äººç±»æ˜¯æ‡’æƒ°çš„åŠ¨ç‰©">äººç±»æ˜¯æ‡’æƒ°çš„åŠ¨ç‰©&lt;/h2>
&lt;p>ä½†è¿™æ ·è¿˜æ˜¯éœ€è¦è‡ªå·±æ‰‹æ‰“éœ€è¦åˆ‡å‰²çš„æ–‡ä»¶åï¼Œä¸å¤Ÿçˆ½ã€‚å°è¯•æŠŠä»£ç å†å˜é•¿ä¸€ç‚¹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>ls | grep .csv$ | sed &amp;rsquo;s/.csv//g&amp;rsquo; | xargs -n1 -I file split -l 1000 file.csv -d -a 3 file**&amp;amp;&amp;amp; ls | grep** | xargs -n1 -I file mv file file.csv&lt;/p>
&lt;/blockquote>
&lt;p>ä»¥ç®¡é“å‘½ä»¤åˆ†å‰²è§£é‡Šä¸€ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;code>ls&lt;/code> åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•&lt;/li>
&lt;li>&lt;code>grep .csv$&lt;/code> ç­›é€‰æ‰©å±•åæ˜¯ csv çš„æ‰€æœ‰æ–‡ä»¶&lt;/li>
&lt;li>&lt;code>sed 's/.csv//g'&lt;/code> å»é™¤æ‰©å±•åï¼Œåªç•™æ–‡ä»¶å&lt;/li>
&lt;li>&lt;code>xargs -n1 -I file split -l 1000 file.csv -d -a 3 file__&lt;/code> åˆ‡å‰²æ‰€æœ‰çš„æ–‡ä»¶&lt;/li>
&lt;li>&lt;code>ls&lt;/code> åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•&lt;/li>
&lt;li>&lt;code>grep __&lt;/code> ç­›é€‰æ–‡ä»¶ååŒ…å«&lt;code>__&lt;/code>çš„æ–‡ä»¶ï¼ˆä¸Šä¸€æ­¥åˆ‡å‰²å¥½çš„æ–‡ä»¶ï¼‰&lt;/li>
&lt;li>&lt;code>xargs -n1 -I file mv file file.csv&lt;/code> åŠ ä¸Šæ‰©å±•å&lt;/li>
&lt;/ol>
&lt;p>çˆ½åˆæ­»äº†ã€‚&lt;/p>
&lt;h2 id="eof">EOF&lt;/h2>
&lt;p>å°è¯•åœ¨ windows ä¸Šï¼ˆCmder+Githubï¼‰åšç±»ä¼¼çš„æ“ä½œï¼Œå‘ç°è¿œæ²¡æœ‰åœ¨è™šæ‹Ÿæœºï¼ˆUbuntuï¼‰é‡Œæ‰§è¡Œå¿«ï¼Œåƒåœ¾å¾®è½¯.jpg&lt;/p></description></item><item><title>RSS å’•å’•æœº</title><link>https://naizi.ch/2019/10/02/rss-%E5%92%95%E5%92%95%E6%9C%BA/</link><pubDate>Wed, 02 Oct 2019 00:00:00 +0000</pubDate><guid>https://naizi.ch/2019/10/02/rss-%E5%92%95%E5%92%95%E6%9C%BA/</guid><description>&lt;p>ä¹‹å‰ä»åŒäº‹é‚£é‡ŒäºŒæ‰‹ä¹°äº†ä¸ªå’•å’•æœºï¼Œå½“ç©å…·ç©ã€‚äº«å—äº†å‡ å¤©ä½¿ç”¨ APP æ‰“å°å„ç§æ²™é›•ç…§ç‰‡å’Œè¡¨æƒ…åŒ…å¸¦æ¥çš„ä¹è¶£åï¼Œå®ƒæ¯«æ— æ„å¤–çš„å¼€å§‹åƒç°ï¼Œå°±å’Œæ¡Œå­æ—è¾¹çš„æ ‘è“æ´¾ä¸€æ ·æŸ“ä¸Šå†å²çš„é¢œè‰²ã€‚&lt;/p>
&lt;p>è¿˜æ˜¯æ‹¿å‡ºæ¥ç”¨ç”¨å§â€¦â€¦&lt;/p>
&lt;p>å’•å’•æœº APP é‡Œçš„ä¸€éƒ¨åˆ†è®¢é˜…å·çš„ç¡®æœ‰ç‚¹æ„æ€ï¼Œæ¯”å¦‚è®¢é˜…æ¯å¤©å¤©æ°”ï¼Œæ—©ä¸Š 8 ç‚¹è‡ªåŠ¨æ‰“å°ä¸€æ¡å¤©æ°”å†…å®¹ä¹‹ç±»çš„ã€‚é‚£ä¹ˆæ‹¿æ¥è®¢é˜…å¾®åšæ›´æ–°å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆä¸å¯¹çš„ã€‚&lt;/p>
&lt;p>åæ­£ä¸€å¤©æœ‰ 12 å°æ—¶åœ¨å…¬å¸ï¼Œé—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œä¸å®šæ—¶çš„æ¥ä¸€æ®µå°çº¸æ¡ä¹Ÿä¸é”™ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="å¼€å‘è€…ç”³è¯·">å¼€å‘è€…ç”³è¯·&lt;/h2>
&lt;p>ä¸ºäº†åšåˆ°è¿™äº›ï¼Œé¦–å…ˆè¦å»å’•å’•æœºçš„&lt;a class="link" href="http://open.memobird.cn" target="_blank" rel="noopener"
>å¼€å‘è€…é¡µé¢&lt;/a>ç”³è¯· APPKEYã€‚å¡«å†™å¿…è¦çš„ä¿¡æ¯ç„¶åæäº¤ç”³è¯·å°±è¡Œäº†ã€‚ç­‰äº†ä¸€å‘¨å·¦å³ç”³è¯·å°±é€šè¿‡äº†ã€‚&lt;/p>
&lt;p>æ‹¿åˆ° APPKEY ä¹‹åï¼Œå¯ä»¥æŸ¥é˜…å®˜æ–¹ç»™çš„æ–‡æ¡£ï¼Œå¯ç”¨çš„ API å…¶å®ä¸å¤šï¼Œæ›´å¤šè¿˜æ˜¯è¦é è‡ªå·±å»ç”Ÿæˆå†…å®¹ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/Windfarer/pymobird" target="_blank" rel="noopener"
>GitHub&lt;/a>ä¸Šä¹Ÿæœ‰å…¶ä»–å¼€å‘è€…å†™çš„ SDKï¼Œå¯ä»¥ä¸ç”¨è‡ªå·±é‡å¤æŒ‰ç…§å®˜æ–¹æ–‡æ¡£é€ è½®å­ã€‚&lt;/p>
&lt;h2 id="rss">RSS&lt;/h2>
&lt;p>æ‰“ä¸ªæ¯”æ–¹ï¼Œè®¢é˜…&lt;a class="link" href="https://space.bilibili.com/332704117/dynamic" target="_blank" rel="noopener"
>å°ç‹ç‹¸&lt;/a>çš„ B ç«™åŠ¨æ€ã€‚&lt;/p>
&lt;p>ç†Ÿç»ƒçš„æ‰“å¼€å°ç‹ç‹¸çš„ç©ºé—´ï¼ŒF12ï¼Œåˆ·æ–°ï¼Œè¿‡æ»¤ XHRï¼Œæ‰¾åˆ° API æ¥å£&lt;code>https://api.vc.bilibili.com/dynamic_svr/v1/dynamic_svr/space_history&lt;/code>ã€‚B ç«™çš„åŠ¨æ€æœ‰å¤šç§ç±»å‹ï¼Œéœ€è¦æ ¹æ®ç±»å‹åˆ¤æ–­çˆ¬å–çš„å†…å®¹ã€‚&lt;/p>
&lt;p>&lt;code>['data']['cards']['desc']['type']&lt;/code>çš„å€¼è¡¨æ˜äº†åŠ¨æ€æ˜¯ä½•ç§ç±»å‹ï¼Œæ¯”å¦‚ 1 æ˜¯æŒ‡è½¬å‘ï¼Œ2 æ˜¯å¸¦å›¾åŠ¨æ€ï¼Œ4 æ˜¯çº¯æ–‡å­—åŠ¨æ€ï¼Œ8 æ˜¯æŠ•ç¨¿è§†é¢‘æ¨é€ã€‚&lt;/p>
&lt;p>åœ¨ &lt;code>['data']['cards']['card']&lt;/code> ä¸­æ˜¯ä¸€ä¸² JSON æ•°æ®ï¼ŒåŠ¨æ€çš„æ–‡æœ¬å†…å®¹æ ¹æ®ä¸Šé¢ä¸åŒçš„ç±»å‹å­˜åœ¨ä¸åŒçš„é”®å€¼é‡Œï¼Œæ¯”å¦‚&lt;code>['dynamic']&lt;/code>ã€&lt;code>['item']['content']&lt;/code>ã€&lt;code>['item']['description']&lt;/code>è¿™å‡ ä¸ªä½ç½®ã€‚&lt;/p>
&lt;h2 id="å›¾ç‰‡å­˜å‚¨">å›¾ç‰‡å­˜å‚¨&lt;/h2>
&lt;p>åªæœ‰æ–‡æœ¬å†…å®¹çš„çº¸æ¡å¤ªå•è°ƒäº†ï¼Œä¿¡æ¯é‡ä¹Ÿä¸å¤Ÿï¼Œè¿˜æ˜¯éœ€è¦èƒ½å¤ŸåŒæ—¶æ‰“å°å›¾ç‰‡å†…å®¹ã€‚ä½†å›¾ç‰‡æ‰“å°ä¼šå¢åŠ æ‰“å°æ—¶é—´å’Œä¸‹è½½æ—¶é—´ï¼ŒæŠ˜è¡·é€‰æ‹©åªä¿å­˜é™„å¸¦å›¾ç‰‡çš„ç¬¬ä¸€å¼ ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¿æŒç›®å½•æ•´æ´ï¼Œå›¾ç‰‡æ•°æ®å…¨éƒ¨ç”¨ sqlite3 å­˜å‚¨ã€‚&lt;/p>
&lt;h2 id="å†…å®¹æ›´æ–°">å†…å®¹æ›´æ–°&lt;/h2>
&lt;p>ä¸ºäº†é¿å…é‡å¤æ‰“å°æµªè´¹çº¸å¼ ï¼Œæ¯æ¬¡çˆ¬å–æ•°æ®æ—¶éœ€è¦åˆ¤æ–­æ˜¯å¦æœ‰æ–°çš„å†…å®¹ã€‚&lt;/p>
&lt;p>å»ºæ•°æ®è¡¨ï¼Œåªå­˜å‚¨å¿…è¦çš„æ—¶é—´ã€æ—¥æœŸã€æ–‡å­—å†…å®¹å’Œå›¾ç‰‡æ•°æ®ï¼ŒåŠ ä¸ŠåŠ¨æ€çš„ ID ä½œä¸ºä¸»é”®æ¥è¿›è¡Œå»é‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">CREATE&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">IF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">EXISTS&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">ç™½ä¸Šå¹é›ª&lt;/span>Official (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">day&lt;/span> VARCHAR,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _id VARCHAR &lt;span style="color:#66d9ef">PRIMARY&lt;/span> &lt;span style="color:#66d9ef">KEY&lt;/span> &lt;span style="color:#66d9ef">UNIQUE&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> msg VARCHAR,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pic BLOB,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> title VARCHAR);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åäººå·¥æ’å…¥ä¸€æ¡ id ä¸º 0 çš„æ•°æ®ï¼Œç”¨æ¥è®°å½•æ˜¯å¦è·å–åˆ°æ–°å†…å®¹ï¼Œæ¯æ¬¡å…ˆå•ç‹¬æŸ¥è¯¢è¿™ä¸€è¡Œï¼Œæœ‰æ–°æ•°æ®å†å–å‡ºå†…å®¹è¿›è¡Œæ‰“å°ã€‚&lt;/p>
&lt;h2 id="post-è¯·æ±‚æ‰“å°">POST è¯·æ±‚æ‰“å°&lt;/h2>
&lt;p>åˆ©ç”¨ä¹‹å‰æåˆ°çš„ SDKï¼Œå°†æ–‡å­—å’Œå›¾ç‰‡çš„å¤åˆå†…å®¹æ•´åˆåä¸€èµ· POST ç»™æœåŠ¡å™¨ã€‚&lt;/p>
&lt;h3 id="å°èŠ±æ ·">å°èŠ±æ ·&lt;/h3>
&lt;p>ä¸ºäº†åŒºåˆ†æ™®é€šçš„å¸¦å›¾åŠ¨æ€å’Œè§†é¢‘æŠ•ç¨¿çš„æ¨é€ï¼Œä»¿ç…§åŠ¨æ€çš„æ ·å¼ç»™è§†é¢‘æŠ•ç¨¿çš„å›¾åƒåŠ ä¸Šäº†è§’æ ‡ã€‚åŒæ—¶å› ä¸ºå’•å’•æœºé‡‡ç”¨çš„æ˜¯ WiFi æ‰“å°ï¼Œä¸ºäº†å‡å°æ–‡ä»¶ä½“ç§¯ï¼ŒPOST æ•°æ®å‰å¯¹å›¾ç‰‡å°ºå¯¸è¿›è¡Œç¼©å°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> pymobird &lt;span style="color:#f92672">import&lt;/span> Content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> pymobird &lt;span style="color:#f92672">import&lt;/span> Content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bird &lt;span style="color:#f92672">=&lt;/span> SimplePymobird(appkey, device_id, user_id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content &lt;span style="color:#f92672">=&lt;/span> Content()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content&lt;span style="color:#f92672">.&lt;/span>add_text(&lt;span style="color:#e6db74">&amp;#39;ã€&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">ã€‘&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname)) &lt;span style="color:#75715e"># ç”¨æˆ·å&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content&lt;span style="color:#f92672">.&lt;/span>add_text(time&lt;span style="color:#f92672">.&lt;/span>strftime(&lt;span style="color:#e6db74">&amp;#39;%Y-%m-&lt;/span>&lt;span style="color:#e6db74">%d&lt;/span>&lt;span style="color:#e6db74"> %H:%M&amp;#39;&lt;/span>,time&lt;span style="color:#f92672">.&lt;/span>gmtime(int(day)))) &lt;span style="color:#75715e"># æ—¥æœŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content&lt;span style="color:#f92672">.&lt;/span>add_text(&lt;span style="color:#e6db74">&amp;#39;https://t.bilibili.com/&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(_id)) &lt;span style="color:#75715e"># é“¾æ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content&lt;span style="color:#f92672">.&lt;/span>add_text(msg) &lt;span style="color:#75715e"># æ–‡å­—å†…å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> Image
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> ImageDraw
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> ImageFont
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>img &lt;span style="color:#f92672">=&lt;/span> Image&lt;span style="color:#f92672">.&lt;/span>open(&lt;span style="color:#e6db74">&amp;#39;peitu.jpg&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>img&lt;span style="color:#f92672">.&lt;/span>thumbnail((&lt;span style="color:#ae81ff">400&lt;/span>, &lt;span style="color:#ae81ff">400&lt;/span>), Image&lt;span style="color:#f92672">.&lt;/span>ANTIALIAS)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>font &lt;span style="color:#f92672">=&lt;/span> ImageFont&lt;span style="color:#f92672">.&lt;/span>truetype(&lt;span style="color:#e6db74">&amp;#39;SourceHanSansCN-Regular.otf&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">22&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>draw &lt;span style="color:#f92672">=&lt;/span> ImageDraw&lt;span style="color:#f92672">.&lt;/span>Draw(img)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>draw&lt;span style="color:#f92672">.&lt;/span>rectangle(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#ae81ff">268&lt;/span>, &lt;span style="color:#ae81ff">15&lt;/span>, &lt;span style="color:#ae81ff">368&lt;/span>, &lt;span style="color:#ae81ff">47&lt;/span>), fill&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#ae81ff">250&lt;/span>, &lt;span style="color:#ae81ff">115&lt;/span>, &lt;span style="color:#ae81ff">150&lt;/span>), outline&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#ae81ff">250&lt;/span>, &lt;span style="color:#ae81ff">140&lt;/span>, &lt;span style="color:#ae81ff">160&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>draw&lt;span style="color:#f92672">.&lt;/span>text((&lt;span style="color:#ae81ff">274&lt;/span>, &lt;span style="color:#ae81ff">14&lt;/span>), &lt;span style="color:#e6db74">&amp;#39;æŠ•ç¨¿è§†é¢‘&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;#FFFFFF&amp;#39;&lt;/span>, font&lt;span style="color:#f92672">=&lt;/span>font)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>img&lt;span style="color:#f92672">.&lt;/span>save(&lt;span style="color:#e6db74">&amp;#39;peitu.png&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;PNG&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content&lt;span style="color:#f92672">.&lt;/span>add_image(&lt;span style="color:#e6db74">&amp;#39;peitu.png&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>result &lt;span style="color:#f92672">=&lt;/span> bird&lt;span style="color:#f92672">.&lt;/span>print_multi_part_content(content)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="crontab-å®šæ—¶ä»»åŠ¡">Crontab å®šæ—¶ä»»åŠ¡&lt;/h2>
&lt;p>å¼€ SSH æŠŠè„šæœ¬æ‰”è¿›å¯Œæœ‰å†å²æ„Ÿçš„æ ‘è“æ´¾ã€‚&lt;/p>
&lt;blockquote>
&lt;p>crontab -e&lt;/p>
&lt;p>*/5 * * * * python3 bilibili_fubuki.py&lt;/p>
&lt;/blockquote>
&lt;h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç &lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## -*- coding: utf-8 -*-&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> re
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sqlite3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## bilibili&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uname &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ç™½ä¸Šå¹é›ª Official&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uid &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;332704117&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## memobird&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>appkey &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>device_id &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>user_id &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>headers &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;User-Agent&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;application/json, text/plain, */*&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept-Language&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Origin&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;https://space.bilibili.com&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;DNT&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Connection&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;keep-alive&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Referer&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;https://space.bilibili.com/&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>newfile &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">not&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>exists(&lt;span style="color:#e6db74">&amp;#39;bilibili_&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.sqlite&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>db &lt;span style="color:#f92672">=&lt;/span> sqlite3&lt;span style="color:#f92672">.&lt;/span>connect(&lt;span style="color:#e6db74">&amp;#39;bilibili_&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.sqlite&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname), isolation_level&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur &lt;span style="color:#f92672">=&lt;/span> db&lt;span style="color:#f92672">.&lt;/span>cursor()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">CREATE TABLE
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">IF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> NOT EXISTS &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> (
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> day VARCHAR,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> _id VARCHAR PRIMARY KEY UNIQUE,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> msg VARCHAR,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> pic BLOB,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> title VARCHAR);&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> newfile:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;INSERT INTO &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> VALUES ( ?, ?, ?, ?, ? );&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#66d9ef">None&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">None&lt;/span>, &lt;span style="color:#66d9ef">None&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">bili_pic&lt;/span>(link):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> file &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>get(link, headers&lt;span style="color:#f92672">=&lt;/span>headers)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> file&lt;span style="color:#f92672">.&lt;/span>content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> params &lt;span style="color:#f92672">=&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;visitor_uid&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;host_uid&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uid)),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;offset_dynamic_id&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>get(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;https://api.vc.bilibili.com/dynamic_svr/v1/dynamic_svr/space_history&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> headers&lt;span style="color:#f92672">=&lt;/span>headers,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> params&lt;span style="color:#f92672">=&lt;/span>params)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;code&amp;#39;&lt;/span>) &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(result&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;message&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> card &lt;span style="color:#f92672">in&lt;/span> result[&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;cards&amp;#39;&lt;/span>]:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> card_time &lt;span style="color:#f92672">=&lt;/span> card[&lt;span style="color:#e6db74">&amp;#39;desc&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;timestamp&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> card_id &lt;span style="color:#f92672">=&lt;/span> card[&lt;span style="color:#e6db74">&amp;#39;desc&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;dynamic_id_str&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> card_type &lt;span style="color:#f92672">=&lt;/span> card[&lt;span style="color:#e6db74">&amp;#39;desc&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> data &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(card[&lt;span style="color:#e6db74">&amp;#39;card&amp;#39;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> card_type &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> title &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;title&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pic &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;pic&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;dynamic&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">elif&lt;/span> card_type &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> title &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pic &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;item&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;content&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">elif&lt;/span> card_type &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> title &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;item&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;pictures&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pic &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;item&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;pictures&amp;#39;&lt;/span>][&lt;span style="color:#ae81ff">0&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;img_src&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;item&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;description&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">elif&lt;/span> card_type &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> title &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pic &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> data[&lt;span style="color:#e6db74">&amp;#39;item&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;content&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(card_time, card_id, card_type)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> img &lt;span style="color:#f92672">=&lt;/span> bili_pic(pic) &lt;span style="color:#66d9ef">if&lt;/span> pic &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur&lt;span style="color:#f92672">.&lt;/span>execute(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;INSERT OR REPLACE INTO &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> VALUES ( ?, ?, ?, ?, ? );&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> uname), (card_time, card_id, text, img, title))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new &lt;span style="color:#f92672">=&lt;/span> cur&lt;span style="color:#f92672">.&lt;/span>execute(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;SELECT COUNT(_id) FROM &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">;&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))&lt;span style="color:#f92672">.&lt;/span>fetchone()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> old &lt;span style="color:#f92672">=&lt;/span> cur&lt;span style="color:#f92672">.&lt;/span>execute(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;SELECT msg FROM &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> WHERE _id = 0;&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))&lt;span style="color:#f92672">.&lt;/span>fetchone()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> int(new[&lt;span style="color:#ae81ff">0&lt;/span>]) &lt;span style="color:#f92672">==&lt;/span> int(old[&lt;span style="color:#ae81ff">0&lt;/span>]):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;UPDATE &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> SET msg = ? WHERE _id = 0&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (str(new[&lt;span style="color:#ae81ff">0&lt;/span>]), ))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> limit &lt;span style="color:#f92672">=&lt;/span> int(new[&lt;span style="color:#ae81ff">0&lt;/span>]) &lt;span style="color:#f92672">-&lt;/span> int(old[&lt;span style="color:#ae81ff">0&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> limit &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> limit &lt;span style="color:#f92672">=&lt;/span> limit &lt;span style="color:#66d9ef">if&lt;/span> limit &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> pymobird &lt;span style="color:#f92672">import&lt;/span> Content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> pymobird &lt;span style="color:#f92672">import&lt;/span> SimplePymobird
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bird &lt;span style="color:#f92672">=&lt;/span> SimplePymobird(ak&lt;span style="color:#f92672">=&lt;/span>appkey, device_id&lt;span style="color:#f92672">=&lt;/span>device_id, user_id&lt;span style="color:#f92672">=&lt;/span>user_id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> data &lt;span style="color:#f92672">=&lt;/span> cur&lt;span style="color:#f92672">.&lt;/span>execute(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;SELECT day, _id, msg, pic, title FROM &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74"> ORDER BY _id DESC LIMIT &lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">;&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">.&lt;/span>format(uname, limit))&lt;span style="color:#f92672">.&lt;/span>fetchall()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> dynamic &lt;span style="color:#f92672">in&lt;/span> data[::&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>]:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> day, _id, msg, pic, title &lt;span style="color:#f92672">=&lt;/span> dynamic
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">=&lt;/span> Content()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_text(&lt;span style="color:#e6db74">&amp;#39;ã€&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">ã€‘&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_text(time&lt;span style="color:#f92672">.&lt;/span>strftime(&lt;span style="color:#e6db74">&amp;#39;%Y-%m-&lt;/span>&lt;span style="color:#e6db74">%d&lt;/span>&lt;span style="color:#e6db74"> %H:%M&amp;#39;&lt;/span>,time&lt;span style="color:#f92672">.&lt;/span>gmtime(int(day))))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_text(&lt;span style="color:#e6db74">&amp;#39;https://t.bilibili.com/&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(_id))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_text(msg)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> pic:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.jpg&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname), &lt;span style="color:#e6db74">&amp;#39;wb&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(pic)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> img &lt;span style="color:#f92672">=&lt;/span> Image&lt;span style="color:#f92672">.&lt;/span>open(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.jpg&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> img&lt;span style="color:#f92672">.&lt;/span>thumbnail((&lt;span style="color:#ae81ff">400&lt;/span>, &lt;span style="color:#ae81ff">400&lt;/span>), Image&lt;span style="color:#f92672">.&lt;/span>ANTIALIAS)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> title:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> Image
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> ImageDraw
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">from&lt;/span> PIL &lt;span style="color:#f92672">import&lt;/span> ImageFont
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_text(title)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> font &lt;span style="color:#f92672">=&lt;/span> ImageFont&lt;span style="color:#f92672">.&lt;/span>truetype(&lt;span style="color:#e6db74">&amp;#39;SourceHanSansCN-Regular.otf&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">22&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> draw &lt;span style="color:#f92672">=&lt;/span> ImageDraw&lt;span style="color:#f92672">.&lt;/span>Draw(img)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> draw&lt;span style="color:#f92672">.&lt;/span>rectangle((&lt;span style="color:#ae81ff">268&lt;/span>, &lt;span style="color:#ae81ff">15&lt;/span>, &lt;span style="color:#ae81ff">368&lt;/span>, &lt;span style="color:#ae81ff">47&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fill&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#ae81ff">250&lt;/span>, &lt;span style="color:#ae81ff">115&lt;/span>, &lt;span style="color:#ae81ff">150&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> outline&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#ae81ff">250&lt;/span>, &lt;span style="color:#ae81ff">140&lt;/span>, &lt;span style="color:#ae81ff">160&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> draw&lt;span style="color:#f92672">.&lt;/span>text((&lt;span style="color:#ae81ff">274&lt;/span>, &lt;span style="color:#ae81ff">14&lt;/span>), &lt;span style="color:#e6db74">&amp;#39;æŠ•ç¨¿è§†é¢‘&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;#FFFFFF&amp;#39;&lt;/span>, font&lt;span style="color:#f92672">=&lt;/span>font)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> img&lt;span style="color:#f92672">.&lt;/span>save(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.png&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname), &lt;span style="color:#e6db74">&amp;#39;PNG&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content&lt;span style="color:#f92672">.&lt;/span>add_image(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">.png&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(uname))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> bird&lt;span style="color:#f92672">.&lt;/span>print_multi_part_content(content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(result)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> time&lt;span style="color:#f92672">.&lt;/span>sleep(&lt;span style="color:#ae81ff">5&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;__main__&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> main()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="eof">EOF&lt;/h2>
&lt;p>&lt;img src="https://naizi.ch/pic/2019-10-02-memobird-rss/2019-10-02_20-38.gif"
loading="lazy"
alt="gugugu"
>&lt;/p></description></item><item><title>å“”å“©å“”å“©ä¸‹è½½å·¥å…· äºŒ</title><link>https://naizi.ch/2019/04/30/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7-%E4%BA%8C/</link><pubDate>Tue, 30 Apr 2019 00:00:00 +0000</pubDate><guid>https://naizi.ch/2019/04/30/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7-%E4%BA%8C/</guid><description>&lt;p>ä¸»è¦è§£å†³ä¸€äº›ä¹‹å‰é‡åˆ°çš„å‘ï¼Œå¡«ä¸€äº›ç•™ä¸‹çš„ TODOã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="vegas-ä¸æ”¯æŒ-hevc-ç¼–ç ">Vegas ä¸æ”¯æŒ HEVC ç¼–ç &lt;/h2>
&lt;p>æ€è·¯å¾ˆç®€å•ï¼Œå¯¹ä¸‹è½½ä¸‹æ¥çš„&lt;code>m4s&lt;/code>å…ˆè¯»ä¸€éç¼–ç ï¼Œçœ‹æ˜¯ä¸æ˜¯ HEVC æ ¼å¼çš„ï¼Œå¦‚æœæ˜¯å°±åœ¨è½¬ç çš„æ—¶å€™ç”¨&lt;code>libx264&lt;/code>ç¼–ç ï¼Œä¸æ˜¯å°±ç²—æš´çš„ copy è§†é¢‘æµã€‚&lt;/p>
&lt;p>æš‚æ—¶ä¸æ‰“ç®—åŠ ä¸Šåˆ¤æ–­å…¶ä»–è§†é¢‘æµæ ¼å¼çš„ä»£ç ï¼Œé‡åˆ°å†è¯´ã€‚&lt;/p>
&lt;h3 id="é€šè¿‡-ffprobe-åˆ¤æ–­ç¼–ç ">é€šè¿‡ ffprobe åˆ¤æ–­ç¼–ç &lt;/h3>
&lt;p>å› ä¸ºä¹‹å‰å¾ˆå°‘æ¥è§¦è§†é¢‘è½¬ç ï¼Œä¹Ÿæ²¡ä»€ä¹ˆæœºä¼šç”¨ ffmpegã€‚åœ¨åˆ¤æ–­ HEVC ç¼–ç è¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œæƒ³ç€ç”¨ç±»ä¼¼&lt;code>ffmpeg -args | find &amp;quot;stream&amp;quot;&lt;/code>çš„æ–¹å¼æ¥å–å¾—è§†é¢‘ç¼–ç ã€‚&lt;/p>
&lt;p>å¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ï¼Œæ²¡æˆåŠŸï¼Œè€Œä¸”è¿˜è¦å¦å†™æ­£åˆ™åŒ¹é…æ–‡æœ¬æœ‰äº›éº»çƒ¦ã€‚æŸ¥äº†ä¸€ä¸‹æ”¹ç”¨ ffprobeã€‚&lt;/p>
&lt;blockquote>
&lt;p>ffprobe.exe -v error -select_streams v:0 -show_entries stream=codec_name &lt;br>
-of default=nokey=1:noprint_wrappers=1 v.m4s &amp;raquo; ./t.txt&lt;/p>
&lt;/blockquote>
&lt;h2 id="ffmpeg-åˆå¹¶-flv">ffmpeg åˆå¹¶ flv&lt;/h2>
&lt;p>ffmpeg çš„é—®é¢˜ä¸»è¦å‡ºç°åœ¨åˆå¹¶ flv ä¸Šï¼Œdash è§†é¢‘å€’æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p>
&lt;p>é‡‡ç”¨&lt;code>-f concat -i file.list&lt;/code>çš„æ–¹å¼åˆå¹¶é‡åˆ°äº†è·¯å¾„é—®é¢˜ã€‚å› ä¸ºå¬å–äº†å»ºè®®â€œä¸‹è½½çš„æ–‡ä»¶æœ€å¥½å•ç‹¬æ”¾ä¸ªç›®å½•ï¼Œç›´æ¥ä¸‹åœ¨è„šæœ¬æ ¹ç›®å½•å°±ä¼šå¾ˆä¹±â€ã€‚&lt;/p>
&lt;p>æ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¸‹è½½åœ¨äº†å­æ–‡ä»¶å¤¹é‡Œï¼Œæ¯”å¦‚&lt;code>./down&lt;/code>ã€‚åœ¨ä¸‹è½½ flv åˆ†æ®µçš„æ—¶å€™ï¼Œæ–‡ä»¶çš„ç›®å½•ç»“æ„å°±ç±»ä¼¼ï¼š&lt;/p>
&lt;blockquote>
&lt;p>..
ffmpeg.exe
/down
/down/file.list
/down/part1.flv
/down/part2.flv&lt;/p>
&lt;/blockquote>
&lt;p>ffmpeg çš„å‘½ä»¤å†™æˆï¼š&lt;/p>
&lt;blockquote>
&lt;p>ffmpeg -safe 0 -hide_banner -f concat -i ./down/file.list -c copy ./down/finish.mp4&lt;/p>
&lt;/blockquote>
&lt;p>é—®é¢˜æ¥äº†ï¼Œfile.list é‡Œè¯¥æ€ä¹ˆå†™ï¼Œæˆ‘åŸæœ¬ä»¥ä¸ºåº”è¯¥æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>file &amp;lsquo;./down/part1.flv&amp;rsquo;
file &amp;lsquo;./down/part2.flv&amp;rsquo;
file &amp;lsquo;./down/part3.flv&amp;rsquo;&lt;/p>
&lt;/blockquote>
&lt;p>ç„¶è€Œè¿™æ · ffmpeg ä¼šæŠ¥é”™æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯é‡Œæç¤ºçš„æ–‡ä»¶è·¯å¾„ï¼Œåº”è¯¥æ”¹æˆ&lt;/p>
&lt;blockquote>
&lt;p>file &amp;lsquo;part1.flv&amp;rsquo;
file &amp;lsquo;part2.flv&amp;rsquo;
file &amp;lsquo;part3.flv&amp;rsquo;&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹æ¥ file.list é‡Œçš„æ ¹ç›®å½•æ˜¯ file.list æ‰€åœ¨ç›®å½•ã€‚&lt;/p>
&lt;h2 id="é€šè¿‡å­è¿›ç¨‹åŠ é€Ÿä¸‹è½½">é€šè¿‡å­è¿›ç¨‹åŠ é€Ÿä¸‹è½½&lt;/h2>
&lt;p>éŸ³é¢‘å’Œè§†é¢‘åŒæ—¶ä¸‹è½½ã€‚å› ä¸ºåŸæœ¬ç”¨ os.system çš„æ–¹å¼ä¼šé˜»å¡ï¼Œæ”¹ç”¨ subprocess.Popen å­è¿›ç¨‹ï¼Œç„¶ååœ¨ ffmpeg åˆå¹¶å‰é˜»å¡ä¸¤ä¸ªå­è¿›ç¨‹ï¼Œç¡®ä¿ä¸‹è½½å®Œæ¯•å†è¿›è¡Œåˆå¹¶ã€‚&lt;/p>
&lt;p>å•ä¸ªä»»åŠ¡çš„è¯å°±ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œç„¶åå¼€å¯å¤šè¿›ç¨‹åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ä½†æ˜¯è¿™æ ·åˆé‡åˆ°äº†æ–°çš„é—®é¢˜ï¼š&lt;/p>
&lt;h3 id="å°è¯•å¤šè¿›ç¨‹å’Œ-pyinstaller-çš„å‘">å°è¯•å¤šè¿›ç¨‹å’Œ pyinstaller çš„å‘&lt;/h3>
&lt;p>å› ä¸ºæœ€åè¦æ‰“åŒ…æˆ exe ç»™å…¶ä»–äººç”¨ï¼Œæ¯•ç«Ÿæ²¡å¿…è¦è®©æ¯ä¸ªäººéƒ½è£…ä¸€ä¸ª python ç¯å¢ƒæ¥è·‘è„šæœ¬ã€‚&lt;/p>
&lt;p>åœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­å‘ç°ï¼Œè™½ç„¶ py è„šæœ¬èƒ½å¤Ÿæ­£ç¡®æ‰§è¡Œï¼Œä½†æ˜¯æ‰“åŒ…å®Œæˆçš„ exe åè€Œå˜æˆäº†ä¸€ä¸ª fork ç‚¸å¼¹ï¼Œä¼šæ— é™çš„äº§ç”Ÿå­è¿›ç¨‹ç›´åˆ°è®©ç³»ç»Ÿå®•æœºã€‚&lt;/p>
&lt;p>å¦‚æ˜¯ä¸‰æ¬¡ä¹‹å Google äº†ä¸€ä¸‹ï¼Œpyinstaller å’Œ multiprocessing ç›¸æ€§ä¸åˆï¼Œä½¿ç”¨ mulitprocessing.Process å’Œ mulitprocessing.Pool çš„ä»£ç åœ¨ pyinstaller ç¼–è¯‘åå°±ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>ç»™å‡ºçš„è§£å†³æ–¹æ³•åªé€‚ç”¨äº python2 ç‰ˆæœ¬ï¼Œè€Œæˆ‘ç”¨çš„æ˜¯ python3.7ï¼Œæ‘Šæ‰‹ã€‚&lt;/p>
&lt;h3 id="æ”¹ç”¨-threading-ç»•è¿‡é—®é¢˜">æ”¹ç”¨ threading ç»•è¿‡é—®é¢˜&lt;/h3>
&lt;p>æ—¢ç„¶ä¸èƒ½ç”¨å¤šè¿›ç¨‹ï¼Œé‚£å°±ç”¨å¤šçº¿ç¨‹å¥½äº†ã€‚&lt;/p>
&lt;p>è€Œä¸”å®é™…ä¸Šæˆ‘ä¹Ÿçš„ç¡®æ˜¯å…ˆç”¨çš„ threading åº“ï¼Œé‡åˆ°äº†é—®é¢˜æ‰æƒ³çš„ç”¨ multiprocessingã€‚&lt;/p>
&lt;p>åŸå› æ˜¯ threading çš„åœºåˆï¼Œæˆ‘ç¼–è¯‘ exe å®Œæˆï¼Œæµ‹è¯•çš„æ—¶å€™æƒ³ç›´æ¥å…³é—­çª—å£ï¼Œå‘ç°åšä¸åˆ°ã€‚&lt;/p>
&lt;p>ç»“è®ºè€Œä¸”è¿™ä¸ç®—ä»€ä¹ˆé—®é¢˜ï¼Œæ¯”èµ· fork ç‚¸å¼¹è¦å¯æ¥å—çš„å¤šäº†ï¼Œè€Œä¸”ä¸€ä¸ªä¸‹è½½å·¥å…·ï¼Œæœ¬æ¥å°±æ²¡æœ‰å¿…è¦åœ¨ä¸­é€”é€€å‡ºã€‚&lt;/p>
&lt;p>æœ€åä¸Šäº†çº¿ç¨‹æ± &lt;code>from multiprocessing.dummy import Pool as ThreadPool&lt;/code>ï¼Œå¹¸å¥½è¿™æ ·å¹¶ä¸ä¼šå’Œ pyinstaller å†²çªã€‚&lt;/p>
&lt;h2 id="æ”¾å¼ƒå†™é…ç½®æ–‡ä»¶">æ”¾å¼ƒå†™é…ç½®æ–‡ä»¶&lt;/h2>
&lt;p>è®¡åˆ’æŠŠ ffmpeg å’Œ aria2c çš„é…ç½®å•ç‹¬å­˜æ–‡ä»¶çš„æ¥ç€ï¼Œæƒ³æƒ³åˆè¦å¢åŠ ä»£ç é‡ï¼Œè€Œä¸”å‡ ä¹ä¸ä¼šå»åŠ¨è¿™äº›é…ç½®ï¼Œè¿˜æ˜¯ä½œç½¢äº†ã€‚&lt;/p>
&lt;p>ç¡¬ç¼–ç ä¸ä¹ŸæŒºå¥½ä¹ˆ.jpg&lt;/p>
&lt;h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç &lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## -*- coding: utf-8 -*-&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> arrow
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> re
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> subprocess
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> lxml &lt;span style="color:#f92672">import&lt;/span> etree
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> multiprocessing.dummy &lt;span style="color:#f92672">import&lt;/span> Pool &lt;span style="color:#66d9ef">as&lt;/span> ThreadPool
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>today &lt;span style="color:#f92672">=&lt;/span> arrow&lt;span style="color:#f92672">.&lt;/span>utcnow()&lt;span style="color:#f92672">.&lt;/span>format(&lt;span style="color:#e6db74">&amp;#39;YYYY-MM-DD&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>exists(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today)):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>mkdir(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>session &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>session()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>session&lt;span style="color:#f92672">.&lt;/span>headers &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;User-Agent&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;application/json, text/plain, */*&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept-Language&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Referer&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;https://www.bilibili.com/video/av42038790?from=search&amp;amp;seid=4077958841119274554&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Origin&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;https://www.bilibili.com&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;DNT&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Connection&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;keep-alive&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Pragma&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;no-cache&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Cache-Control&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;no-cache&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;cookies&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cookies &lt;span style="color:#f92672">=&lt;/span> f&lt;span style="color:#f92672">.&lt;/span>read()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>session&lt;span style="color:#f92672">.&lt;/span>headers[&lt;span style="color:#e6db74">&amp;#39;cookie&amp;#39;&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> cookies
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">videocid&lt;/span>(aid&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">42038790&lt;/span>, part&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> params &lt;span style="color:#f92672">=&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;aid&amp;#39;&lt;/span>, aid),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;jsonp&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;jsonp&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> session&lt;span style="color:#f92672">.&lt;/span>get(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;https://api.bilibili.com/x/player/pagelist&amp;#39;&lt;/span>, params&lt;span style="color:#f92672">=&lt;/span>params, ) &lt;span style="color:#75715e"># cookies=cookies)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cid &lt;span style="color:#f92672">=&lt;/span> result[&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>][part &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;cid&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> cid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">videourl&lt;/span>(aid&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">42038790&lt;/span>, cid&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">73802454&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> params &lt;span style="color:#f92672">=&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;avid&amp;#39;&lt;/span>, aid),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;cid&amp;#39;&lt;/span>, cid),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;qn&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;112&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;fnver&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;fnval&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;16&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;otype&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;json&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> session&lt;span style="color:#f92672">.&lt;/span>get(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;https://api.bilibili.com/x/player/playurl&amp;#39;&lt;/span>, params&lt;span style="color:#f92672">=&lt;/span>params,) &lt;span style="color:#75715e"># cookies=cookies)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>) &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> session&lt;span style="color:#f92672">.&lt;/span>get(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;https://api.bilibili.com/pgc/player/web/playurl&amp;#39;&lt;/span>, params&lt;span style="color:#f92672">=&lt;/span>params,) &lt;span style="color:#75715e"># cookies=cookies)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> playinfo &lt;span style="color:#f92672">=&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;result&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> playinfo &lt;span style="color:#f92672">=&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> playinfo &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(aid, &lt;span style="color:#e6db74">&amp;#39;Not Found&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> playinfo&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;dash&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aids &lt;span style="color:#f92672">=&lt;/span> [x[&lt;span style="color:#e6db74">&amp;#39;id&amp;#39;&lt;/span>] &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> playinfo[&lt;span style="color:#e6db74">&amp;#39;dash&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;audio&amp;#39;&lt;/span>]]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aurl &lt;span style="color:#f92672">=&lt;/span> playinfo[&lt;span style="color:#e6db74">&amp;#39;dash&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;audio&amp;#39;&lt;/span>][aids&lt;span style="color:#f92672">.&lt;/span>index(max(aids))][&lt;span style="color:#e6db74">&amp;#39;baseUrl&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vids &lt;span style="color:#f92672">=&lt;/span> [x[&lt;span style="color:#e6db74">&amp;#39;id&amp;#39;&lt;/span>] &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> playinfo[&lt;span style="color:#e6db74">&amp;#39;dash&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;video&amp;#39;&lt;/span>]]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vurl &lt;span style="color:#f92672">=&lt;/span> playinfo[&lt;span style="color:#e6db74">&amp;#39;dash&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;video&amp;#39;&lt;/span>][vids&lt;span style="color:#f92672">.&lt;/span>index(max(vids))][&lt;span style="color:#e6db74">&amp;#39;baseUrl&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ap &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;aria2c.exe -x10 -k1M --file-allocation=none --auto-file-renaming=false &amp;#34;&lt;/span>&lt;span style="color:#e6db74">{aurl}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept: */*&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Referer: https://www.bilibili.com/video/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Origin: https://www.bilibili.com&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;DNT: 1&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Connection: keep-alive&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Pragma: no-cache&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Cache-Control: no-cache&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --out ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_a.m4s&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, aurl&lt;span style="color:#f92672">=&lt;/span>aurl, aid&lt;span style="color:#f92672">=&lt;/span>aid, cid&lt;span style="color:#f92672">=&lt;/span>cid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vp &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;aria2c -x10 -k1M --file-allocation=none --auto-file-renaming=false &amp;#34;&lt;/span>&lt;span style="color:#e6db74">{vurl}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept: */*&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Referer: https://www.bilibili.com/video/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Origin: https://www.bilibili.com&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;DNT: 1&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Connection: keep-alive&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Pragma: no-cache&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Cache-Control: no-cache&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --out ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_v.m4s&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, vurl&lt;span style="color:#f92672">=&lt;/span>vurl, aid&lt;span style="color:#f92672">=&lt;/span>aid, cid&lt;span style="color:#f92672">=&lt;/span>cid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ap&lt;span style="color:#f92672">.&lt;/span>wait()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vp&lt;span style="color:#f92672">.&lt;/span>wait()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vt &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;ffprobe.exe -v error -select_streams v:0 -show_entries stream=codec_name&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> -of default=nokey=1:noprint_wrappers=1&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_v.m4s &amp;gt;&amp;gt; ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_t.txt&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vt&lt;span style="color:#f92672">.&lt;/span>wait()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_t.txt&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid), &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> v_type &lt;span style="color:#f92672">=&lt;/span> str(f&lt;span style="color:#f92672">.&lt;/span>read())&lt;span style="color:#f92672">.&lt;/span>replace(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> v_type &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;hevc&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fp &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;ffmpeg -n -hide_banner -i ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_v.m4s -i ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_a.m4s -c:v libx264 -c:a copy&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">.mp4&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid, aid&lt;span style="color:#f92672">=&lt;/span>aid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fp &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;ffmpeg -n -hide_banner -i ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_v.m4s -i ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_a.m4s -c:v copy -c:a copy&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">.mp4&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid, aid&lt;span style="color:#f92672">=&lt;/span>aid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>remove(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_t.txt&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fp&lt;span style="color:#f92672">.&lt;/span>wait()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>remove(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_a.m4s&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>remove(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{cid}&lt;/span>&lt;span style="color:#e6db74">_v.m4s&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, cid&lt;span style="color:#f92672">=&lt;/span>cid))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">elif&lt;/span> playinfo&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;durl&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vlink &lt;span style="color:#f92672">=&lt;/span> [x[&lt;span style="color:#e6db74">&amp;#39;url&amp;#39;&lt;/span>] &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> playinfo[&lt;span style="color:#e6db74">&amp;#39;durl&amp;#39;&lt;/span>]]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_merge.txt&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, aid&lt;span style="color:#f92672">=&lt;/span>aid), &lt;span style="color:#e6db74">&amp;#39;a&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> t:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> p, link &lt;span style="color:#f92672">in&lt;/span> enumerate(vlink):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t&lt;span style="color:#f92672">.&lt;/span>write(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;file &amp;#39;./av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_&lt;/span>&lt;span style="color:#e6db74">{p}&lt;/span>&lt;span style="color:#e6db74">.flv&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(aid&lt;span style="color:#f92672">=&lt;/span>aid, p&lt;span style="color:#f92672">=&lt;/span>p))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> p, link &lt;span style="color:#f92672">in&lt;/span> enumerate(vlink):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> subprocess&lt;span style="color:#f92672">.&lt;/span>check_call(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;aria2c.exe -x10 -k1M --file-allocation=none --auto-file-renaming=false &amp;#34;&lt;/span>&lt;span style="color:#e6db74">{link}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept: */*&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Referer: https://www.bilibili.com/video/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Origin: https://www.bilibili.com&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;DNT: 1&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Connection: keep-alive&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --header=&amp;#34;Pragma: no-cache&amp;#34; --header=&amp;#34;Cache-Control: no-cache&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> --out ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_&lt;/span>&lt;span style="color:#e6db74">{p}&lt;/span>&lt;span style="color:#e6db74">.flv&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, link&lt;span style="color:#f92672">=&lt;/span>link, aid&lt;span style="color:#f92672">=&lt;/span>aid, p&lt;span style="color:#f92672">=&lt;/span>p), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fp &lt;span style="color:#f92672">=&lt;/span> subprocess&lt;span style="color:#f92672">.&lt;/span>Popen(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;ffmpeg -safe 0 -hide_banner -f concat -i ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_merge.txt -c copy&lt;/span>&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#e6db74"> ./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">.mp4&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, aid&lt;span style="color:#f92672">=&lt;/span>aid), shell&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fp&lt;span style="color:#f92672">.&lt;/span>wait()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>remove(&lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_merge.txt&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, aid&lt;span style="color:#f92672">=&lt;/span>aid))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> p, link &lt;span style="color:#f92672">in&lt;/span> enumerate(vlink):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os&lt;span style="color:#f92672">.&lt;/span>remove(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;./&lt;/span>&lt;span style="color:#e6db74">{today}&lt;/span>&lt;span style="color:#e6db74">/av&lt;/span>&lt;span style="color:#e6db74">{aid}&lt;/span>&lt;span style="color:#e6db74">_&lt;/span>&lt;span style="color:#e6db74">{p}&lt;/span>&lt;span style="color:#e6db74">.flv&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>format(today&lt;span style="color:#f92672">=&lt;/span>today, aid&lt;span style="color:#f92672">=&lt;/span>aid, p&lt;span style="color:#f92672">=&lt;/span>p))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool &lt;span style="color:#f92672">=&lt;/span> ThreadPool(processes&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;down.txt&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aids &lt;span style="color:#f92672">=&lt;/span> re&lt;span style="color:#f92672">.&lt;/span>findall(&lt;span style="color:#e6db74">r&lt;/span>&lt;span style="color:#e6db74">&amp;#39;av(\d+)&amp;#39;&lt;/span>, f&lt;span style="color:#f92672">.&lt;/span>read())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> aids:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>apply_async(videourl, (x, videocid(x)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>join()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;__main__&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> main()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="todo">TODO&lt;/h2>
&lt;ul>
&lt;li>&lt;del>éƒ¨åˆ†è§†é¢‘çš„è§†é¢‘æµæ˜¯ HEVC ç¼–ç è€Œä¸æ˜¯ x264ï¼ŒWindows è¯»ä¸å‡º MP4 ç¼©ç•¥å›¾ï¼Œè€ƒè™‘è¦ä¸è¦åˆ¤æ–­è‡ªåŠ¨è½¬ç ã€‚&lt;/del>&lt;/li>
&lt;li>&lt;del>aria2 å’Œ ffmpeg çš„å‚æ•°å•ç‹¬å­˜æ–‡ä»¶æ–¹ä¾¿ä¿®æ”¹ï¼Œä¸ç„¶æ¯æ¬¡éƒ½è¦é‡æ–°ç¼–è¯‘ exeã€‚&lt;/del>&lt;/li>
&lt;li>åˆ† P é€‰æ‹©å’Œæ¸…æ™°åº¦é€‰æ‹©&lt;/li>
&lt;/ul>
&lt;h2 id="eof">EOF&lt;/h2></description></item><item><title>å¾®åšä¿¡æ¯æµå¹¿å‘ŠæŠ“å–</title><link>https://naizi.ch/2019/01/05/%E5%BE%AE%E5%8D%9A%E4%BF%A1%E6%81%AF%E6%B5%81%E5%B9%BF%E5%91%8A%E6%8A%93%E5%8F%96/</link><pubDate>Sat, 05 Jan 2019 00:00:00 +0000</pubDate><guid>https://naizi.ch/2019/01/05/%E5%BE%AE%E5%8D%9A%E4%BF%A1%E6%81%AF%E6%B5%81%E5%B9%BF%E5%91%8A%E6%8A%93%E5%8F%96/</guid><description>&lt;p>å¾®åšæ³¨å†Œäº†ä¸ªå°å·ï¼Œä¸ºäº†çœ‹çœ‹éƒ½æ˜¯ä»€ä¹ˆç‰›é¬¼è›‡ç¥åœ¨å¾®åšé‡Œæ¨é€ä¿¡æ¯æµå¹¿å‘Šï¼Œå°è¯•æŠ“å–ä¸€ä¸‹ã€‚&lt;/p>
&lt;p>è™½ç„¶æœ‰&lt;a class="link" href="https://github.com/tiansh/yaofang" target="_blank" rel="noopener"
>YAWFï¼ˆYet Another Weibo Filterï¼‰&lt;/a>è¿™æ ·å¥½ç”¨çš„è„šæœ¬å¯ä»¥å±è”½å¹¿å‘Šï¼Œä½†å±è”½äº†å°±çœ‹ä¸åˆ°äº†ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="æ‰¾åˆ°-api-æ¥å£">æ‰¾åˆ° API æ¥å£&lt;/h2>
&lt;p>F12 åˆ‡æ¢åˆ° Networkï¼Œåœ¨é¦–é¡µåˆ·æ–°é¡µé¢ï¼Œç­›é€‰æ•æ‰åˆ° api æ¥å£&lt;code>https://weibo.com/aj/mblog/fsearch&lt;/code>ã€‚&lt;/p>
&lt;p>æ–°å»ºæ ‡ç­¾é¡µè®¿é—®ï¼Œå»æ‰ä¸å¿…è¦çš„å‚æ•°ï¼ˆåŒ…æ‹¬ä¸€å †ç”¨æ¥æŒ‡å®šä¸Šä¸‹æ–‡åŒºé—´å’Œå·²è¯»åˆ†ç•Œçº¿çš„ idï¼‰ï¼Œåªç•™ä¸‹å¿…è¦çš„éƒ¨åˆ†ã€‚&lt;/p>
&lt;p>ç„¶åç›´æ¥ä¸Šä»£ç å¼€å§‹çˆ¬å–å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>headers &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;User-Agent&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;Mozilla/5.0 (X11; Linux x86_64; rv:64.0) Gecko/20100101 Firefox/64.0&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Accept-Language&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;en-US,en;q=0.5&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;DNT&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Connection&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;keep-alive&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Upgrade-Insecure-Requests&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Cache-Control&amp;#39;&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;max-age=0&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;Cookie&amp;#39;&lt;/span>: cookie
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>params &lt;span style="color:#f92672">=&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;ajwvr&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;6&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;pre_page&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;page&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;1&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#e6db74">&amp;#39;pagebar&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>response &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;https://weibo.com/aj/mblog/fsearch&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> headers&lt;span style="color:#f92672">=&lt;/span>headers, params&lt;span style="color:#f92672">=&lt;/span>params)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿”å›æ•°æ®æ˜¯ json ç»“æ„ï¼Œåœ¨&lt;code>data&lt;/code>å­—æ®µé‡Œå­˜æ”¾äº†é¡µé¢å†…å®¹ï¼Œè¿™é‡Œç”¨ lxml åº“è§£æï¼Œä¿å­˜ html æ–‡ä»¶è¿›è¡Œä¸‹ä¸€æ­¥ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> lxml &lt;span style="color:#f92672">import&lt;/span> etree
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>html &lt;span style="color:#f92672">=&lt;/span> etree&lt;span style="color:#f92672">.&lt;/span>HTML(result[&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;feed.html&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;w&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(etree&lt;span style="color:#f92672">.&lt;/span>tostring(html, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;unicode&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="css-ç­›é€‰å¹¿å‘Šå†…å®¹">CSS ç­›é€‰å¹¿å‘Šå†…å®¹&lt;/h2>
&lt;p>æ‰“å¼€ä¿å­˜çš„ htmlï¼Œæ ¼å¼åŒ–ä¸€ä¸‹ä»£ç ï¼Œæ‰¾åˆ°å­˜åœ¨&lt;code>feedtype=&amp;quot;ad&amp;quot;&lt;/code>å±æ€§çš„èŠ‚ç‚¹ï¼ˆå› ä¸ºä¸æ˜¯æ¯æ¬¡è·å–éƒ½ä¼šæœ‰ä¿¡æ¯æµå¹¿å‘Šï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦è·å–å¾ˆå¤šæ¬¡ï¼‰ã€‚&lt;/p>
&lt;p>ç„¶åç»§ç»­å¾€ä¸‹çœ‹å­èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°å…·ä½“çš„å¾®åšé“¾æ¥ï¼š&lt;/p>
&lt;p>&lt;img src="https://naizi.ch/pic/2019-01-05-weibo-feed-adver/2019-01-05_17-47.png"
loading="lazy"
alt="ä¿¡æ¯æµ HTML"
>&lt;/p>
&lt;p>è·å–æ­¤èŠ‚ç‚¹çš„ xpathï¼š&lt;code>&amp;quot;//div[@feedtype]//a[@action-history='rec=1']/@action-data&amp;quot;&lt;/code>&lt;/p>
&lt;p>ç»“åˆæ­£åˆ™è¡¨è¾¾å¼æå–é“¾æ¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> re
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>html &lt;span style="color:#f92672">=&lt;/span> etree&lt;span style="color:#f92672">.&lt;/span>HTML(result[&lt;span style="color:#e6db74">&amp;#39;data&amp;#39;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>links &lt;span style="color:#f92672">=&lt;/span> html&lt;span style="color:#f92672">.&lt;/span>xpath(&lt;span style="color:#e6db74">&amp;#34;//div[@feedtype]//a[@action-history=&amp;#39;rec=1&amp;#39;]/@action-data&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> link &lt;span style="color:#f92672">in&lt;/span> links:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> adver &lt;span style="color:#f92672">=&lt;/span> re&lt;span style="color:#f92672">.&lt;/span>findall(&lt;span style="color:#e6db74">r&lt;/span>&lt;span style="color:#e6db74">&amp;#39;url=([^&amp;amp;]+)&amp;amp;&amp;#39;&lt;/span>, link)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;adver.list&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;a&amp;#39;&lt;/span>, encoding&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;utf-8-sig&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(str(adver)&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åé€šè¿‡ crontab è®¾ç½®æˆå®šæ—¶ä»»åŠ¡è‡ªåŠ¨ç›‘æµ‹ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-crontab.conf" data-lang="crontab.conf">* * * * * python weibo_adver.py
&lt;/code>&lt;/pre>&lt;h2 id="è‡ªåŠ¨æ›´æ–°-cookie">è‡ªåŠ¨æ›´æ–° cookie&lt;/h2>
&lt;p>é«˜é¢‘ç‡çš„è¿ç»­è®¿é—®å¯èƒ½ä¼šé€ æˆå¾®åšæç¤ºå¸å·å¼‚å¸¸ï¼Œè€Œä¸”è¿è¡Œæ—¶é—´ä¹…äº† cookie ä¹Ÿä¼šè¿‡æœŸï¼Œéœ€è¦è‡ªåŠ¨é‡æ–°ç™»å½•è·å– cookieã€‚&lt;/p>
&lt;p>å¾®åšçš„è‡ªåŠ¨ç™»å½•è½®å­å¾ˆå¤šï¼Œä¸ç”¨è‡ªå·±å¦å†™ã€‚cookie è¿‡æœŸçš„åˆ¤æ–­å°±æ¯”è¾ƒç²—æš´äº†ï¼Œå¦‚æœè¯»å–è¿”å›çš„ json æŠ›å‡ºå¼‚å¸¸ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯ cookie è¿‡æœŸé€ æˆçš„ã€‚&lt;/p>
&lt;p>å¦å¤–æµ‹è¯•å‘ç°ï¼Œä¸å¸¦ cookie çš„ api è®¿é—®æ˜¯ä¼šè¿”å›æ­£å¸¸çš„ json æ•°æ®çš„ï¼ˆä½†ä¸åŒ…å« html å†…å®¹ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">login&lt;/span>(username, password):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;somecode balabala&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;cookies&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;w&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(cookies)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>exists(&lt;span style="color:#e6db74">&amp;#39;./cookies&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;./cookies&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;r&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cookie &lt;span style="color:#f92672">=&lt;/span> f&lt;span style="color:#f92672">.&lt;/span>read()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;somecode balabala&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#39;https://weibo.com/aj/mblog/fsearch&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> headers&lt;span style="color:#f92672">=&lt;/span>headers, params&lt;span style="color:#f92672">=&lt;/span>params)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>loads(response&lt;span style="color:#f92672">.&lt;/span>content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">except&lt;/span> json&lt;span style="color:#f92672">.&lt;/span>decoder&lt;span style="color:#f92672">.&lt;/span>JSONDecodeError:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> login(username, password)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;somecode balabala&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> main()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="eof">EOF&lt;/h2>
&lt;p>å°±ç»“æœè€Œè¨€æ•ˆæœè¿˜ä¸é”™ï¼Œä½†ä¹Ÿå‘ç°ä¿¡æ¯æµå¹¿å‘Šé‡Œè¿˜ä¼šæœ‰ä¸€äº›å…³æ³¨äº†çš„åšä¸»çš„æ­£å¸¸å¾®åšå†…å®¹ï¼Œå¯ä»¥è€ƒè™‘å’Œè‡ªå·±çš„å…³æ³¨åˆ—è¡¨å¯¹æ¯”æ¥ç­›é™¤ã€‚&lt;/p>
&lt;p>&lt;img src="https://naizi.ch/pic/2019-01-05-weibo-feed-adver/2019-01-05_18-03.png"
loading="lazy"
alt="ä¿¡æ¯æµå¹¿å‘Š"
>&lt;/p></description></item></channel></rss>